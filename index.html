<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ù…Ù†ØµØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ â€“ Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„ÙŠØ¹Ù‚ÙˆØ¨ÙŠ</title>

<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&display=swap" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
:root{
  --moe:#0b7e88; --ink:#06353b; --bg:#f5f8f8; --card:#ffffff;
  --muted:#6f8e94; --ok:#e9fff4; --vg:#eef5ff; --gd:#fff6ec; --md:#ffefef;
  --lv-excel:#16a34a; --lv-progress:#2563eb; --lv-launch:#f59e0b; --lv-ready:#e11d48;
  --hero-h: 220px;  --hero-w: 1400px;
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:#06353b;font-family:'Tajawal',sans-serif}
a{color:#135;text-decoration:none} a:hover{text-decoration:underline}

/* Hero */
.hero{width:100vw;margin:0;background:var(--bg);height:var(--hero-h);
  display:flex;align-items:center;justify-content:center}
.hero .brand{width:min(var(--hero-w),96vw);height:100%;
  background:url('logo.png') center/contain no-repeat}

/* Page */
.page{max-width:1280px;margin:0 auto;padding:0 16px}

/* Top buttons */
.controls{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;padding:10px 0 14px}
.btn{background:var(--moe);color:#fff;border:0;border-radius:12px;padding:10px 16px;font-weight:700;cursor:pointer;transition:.12s}
.btn:hover{filter:brightness(.97);transform:translateY(-1px)}
.btn.eval{background:linear-gradient(135deg,#0b7e88,#22b8a0)}
.btn.plan{background:linear-gradient(135deg,#2d6cdf,#4cc3ff)}
.btn.ops{background:linear-gradient(135deg,#f59e0b,#ffd166)}
.btn.light{background:#eef6f7;color:#06353b}

/* Fields grid */
.grid{display:grid;grid-template-columns:repeat(4,minmax(240px,1fr));gap:16px}
@media (max-width:1150px){.grid{grid-template-columns:repeat(3,minmax(220px,1fr))}}
@media (max-width:900px){.grid{grid-template-columns:repeat(2,minmax(220px,1fr))}}
@media (max-width:520px){.grid{grid-template-columns:1fr}}

/* Card */
.card{
  background:linear-gradient(180deg,#ffffff 0%,#f9feff 100%);
  border-radius:16px;padding:14px;border:1px solid #e6efef;cursor:pointer;
  transition:transform .12s, box-shadow .12s;
  box-shadow:0 4px 14px rgba(0,0,0,.045);
}
.card:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,.08)}
.card h2{margin:0 0 6px;color:#0b7e88;font-size:20px}
.kpi{display:flex;justify-content:space-between;align-items:center;color:#6f8e94;font-size:13px;gap:8px;flex-wrap:wrap}
.progress{height:10px;background:#e6efef;border-radius:999px;overflow:hidden;margin:8px 0}
.bar{height:100%}

/* Donut (glow) */
.donutWrap{position:relative;height:180px;display:flex;align-items:center;justify-content:center}
.donutCanvas{position:relative;width:100%;height:100%;filter:drop-shadow(0 4px 12px rgba(37,99,235,.15))}
.donutCenter{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;pointer-events:none}
.donutCenter .lvl{font-size:16px;font-weight:800}
.donutCenter .pct{font-size:12px;color:#6f8e94}
.donutWrap::after{content:"";position:absolute;inset:8px;border-radius:999px;box-shadow:0 0 0 0 rgba(37,99,235,.18);animation:pulseD 2.8s ease-in-out infinite}
@keyframes pulseD{0%{box-shadow:0 0 0 0 rgba(37,99,235,.18)}70%{box-shadow:0 0 0 18px rgba(37,99,235,0)}100%{box-shadow:0 0 0 0 rgba(37,99,235,0)}}

/* Full panel */
.fullpanel{position:fixed;inset:0;z-index:9998;background:rgba(6,53,59,.06);display:none;align-items:flex-start;justify-content:center;padding:12px 8px 24px}
.fullpanel .inner{width:min(1400px,96vw);max-height:92vh;overflow:auto;background:#fff;border-radius:16px;border:1px solid #e6efef;padding:14px}
.fullpanel .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;gap:8px;flex-wrap:wrap}
.pills{display:flex;gap:6px;flex-wrap:wrap}
.pill{display:inline-flex;align-items:center;gap:8px;border:0;cursor:pointer;padding:10px 14px;border-radius:999px;font-weight:800}
.pill.report{background:linear-gradient(135deg,#0b7e88,#1398a2);color:#fff}
.pill.plan{background:linear-gradient(135deg,#2563eb,#4cc3ff);color:#fff}
.fullpanel .close{background:#e8eff0;color:#034;border:0;border-radius:10px;padding:8px 12px;cursor:pointer;font-weight:700}

/* Sub cards + table */
.subgrid{display:grid;grid-template-columns:repeat(2,minmax(200px,1fr));gap:10px;margin-bottom:10px}
@media (max-width:680px){.subgrid{grid-template-columns:1fr}}
.subCard{background:radial-gradient(60% 60% at 50% 40%, #ffffff 0%, #f6fcfd 100%);border:1px solid #e6efef;border-radius:14px;padding:10px}

.tableWrap{margin-top:8px;overflow:auto}
table{width:100%;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;table-layout:fixed}
thead th{background:#0f6f79;color:#fff;padding:10px;font-weight:700}
tbody td{padding:10px;border-bottom:1px solid #eef3f3;vertical-align:top;word-break:break-word}
tbody tr:last-child td{border-bottom:0}
.row-excellent{background:var(--ok)} .row-verygood{background:var(--vg)} .row-good{background:var(--gd)} .row-medium{background:var(--md)}

/* Report/Plan columns */
th.col-lvl, td.col-lvl{width:160px}
th.col-crit{width:35%} th.col-imp{width:45%} th.col-evi{width:auto}

/* Evidence actions (icon-only) */
.eviBar{display:flex;gap:6px;justify-content:center;flex-wrap:wrap;margin-top:8px}
.eviDot{width:26px;height:26px;border-radius:999px;border:1px dashed #cfe4e6;background:#fff;display:inline-flex;align-items:center;justify-content:center;font-weight:800;font-size:12px;color:#0b7e88;transition:transform .12s, box-shadow .12s, background .12s}
.eviDot:hover{transform:translateY(-1px);box-shadow:0 4px 10px rgba(0,0,0,.08);background:#f4fbfb}
.eviActions{display:flex;gap:18px;justify-content:center;align-items:center;margin-top:6px}
.eviIcon{font-size:20px;line-height:1;cursor:pointer;user-select:none;transition:transform .12s}
.eviIcon:hover{transform:translateY(-1px)}
.eviIcon.add{color:#0b7e88}
.eviIcon.delete{color:#e11d48}

/* ===== Ø§Ù„ÙˆØ³Ø·: (ØªØ­ØµÙŠÙ„ÙŠ | Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© | Ø§Ù„Ù‚Ø¯Ø±Ø§Øª) ===== */
.metricsRow{display:flex;justify-content:center;align-items:stretch;gap:18px;margin:14px 0 6px;flex-wrap:wrap}
.metricCard{
  position:relative;background:linear-gradient(180deg,#ffffff 0%,#f9feff 100%);
  border-radius:16px;padding:14px;border:1px solid #e6efef;
  box-shadow:0 6px 18px rgba(0,0,0,.06), inset 0 0 0 1px #e6efef;
  transition:transform .12s, box-shadow .12s;
}
.metricCard:hover{transform:translateY(-2px);box-shadow:0 10px 24px rgba(0,0,0,.09), inset 0 0 0 1px #e6efef}
.metricHead{display:flex;justify-content:center;align-items:center;gap:8px;margin-bottom:6px}
.metricTitle{margin:0;color:#0b7e88;font-size:18px;font-weight:800}
.metricBody{display:flex;align-items:center;justify-content:center}
.metricCard.small{width:320px;height:320px;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;margin-inline:auto}
.metricCard.small .metricBody{flex:1;display:flex;align-items:center;justify-content:center}
.metricCard.small .ring{width:110px;height:110px}
.metricCard.small .ring svg{width:110px;height:110px}
.metricCard.small .ringValue{font-size:18px}
.metricCard.lead{width:560px;min-height:320px;margin-inline:auto}

/* Rings */
.ringWrap{display:flex;align-items:center;justify-content:center;gap:12px;width:100%}
.ring{width:96px;height:96px;position:relative}
.ring svg{width:96px;height:96px;display:block}
.ring .bg{stroke:#e6efef;stroke-width:10;fill:none}
.ring .fg{stroke:url(#royalGrad);stroke-width:10;fill:none;stroke-linecap:round;transform:rotate(-90deg);transform-origin:50% 50%}
.ringGlow{position:absolute;inset:-6px;border-radius:999px;box-shadow:0 0 0 0 rgba(37,99,235,.25);animation:pulse 2.2s ease-in-out infinite}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(37,99,235,.24)}70%{box-shadow:0 0 0 16px rgba(37,99,235,0)}100%{box-shadow:0 0 0 0 rgba(37,99,235,0)}}
.ringValue{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:900;font-size:16px;color:#06353b}

/* Leadership icons */
.kbd-icons{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px;justify-content:center}
.kbd-icon{display:flex;align-items:center;gap:8px;border:1px dashed #cfe4e6;background:#fff;padding:8px 10px;border-radius:12px;cursor:pointer;font-weight:800}
.kbd-icon:hover{background:#f4fbfb}
.kbd-icon svg{width:18px;height:18px}

/* Metric image modal */
.metricModal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;z-index:9999;padding:12px}
.metricModal .sheet{max-width:92vw;max-height:88vh;background:#fff;border-radius:16px;overflow:auto;border:1px solid #e6efef}
.metricModal img{display:block;max-width:100%;height:auto}
.metricModal .bar{display:flex;justify-content:space-between;gap:8px;align-items:center;padding:8px 12px;border-bottom:1px solid #eef1f2}
.metricModal .close{border:0;background:#e8eff0;color:#034;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer}

/* Evidence modal */
.modal{position:fixed;inset:0;display:none;z-index:10000;align-items:center;justify-content:center;background:rgba(6,53,59,.18);padding:12px}
.modal .sheet{width:min(920px,96vw);background:#fff;border-radius:16px;box-shadow:0 20px 40px rgba(0,0,0,.25);padding:14px;border:1px solid #e6efef;max-height:90vh;overflow:auto}
.modal .row{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:8px}
.modal label{display:block;font-size:12px;color:#355;margin-bottom:4px}
.modal input,.modal select{width:100%;padding:10px;border-radius:10px;border:1px solid #dfecec;background:#fff}
.modal .close{background:#e8eff0;color:#034;border:0;border-radius:10px;padding:8px 12px;cursor:pointer;font-weight:700}
@media (max-width:1200px){.metricsRow{justify-content:center}.metricCard.lead{width:min(560px,95vw)}}
@media (max-width:960px){ .metricsRow{flex-direction:column;align-items:center} }
@media (max-width:780px){ .modal .row{grid-template-columns:1fr} }

/* Footer & print */
.footer{padding:18px 10px;text-align:center;color:#7a9aa0}
@page{size:A4;margin:10mm}
@media print{
  .controls,.no-print,.fullpanel,.modal,.metricModal{display:none!important}
  .page{max-width:100%;margin:0 auto!important;padding:0 10mm}
  .hero{box-shadow:none!important;border-radius:0!important}
}
</style>
</head>

<body>
  <!-- Hero -->
  <div class="hero" aria-label="ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… â€“ Ø´Ø¹Ø§Ø±">
    <div class="brand"></div>
  </div>

  <div class="page">
    <div class="controls">
      <button class="btn eval" id="btnExt2025" type="button">Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ Ù¢Ù Ù¢Ù¥Ù… ğŸ“„</button>
      <button class="btn eval" id="btnExt2024" type="button">Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ Ù¢Ù Ù¢Ù¤Ù… ğŸ“„</button>
      <button class="btn" id="btnAnalyze" type="button">ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ ğŸ”</button>
      <button class="btn plan" id="btnFullPlan" type="button">Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ† ğŸ—‚ï¸</button>
      <button class="btn ops" id="btnOps" type="button">Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ© ğŸ—‚ï¸</button>
    </div>

    <div id="dashboard" class="grid"></div>
    <section id="metricsSection" class="metricsRow"></section>

    <div class="footer">ØªÙ†ÙÙŠØ° ÙˆØªØµÙ…ÙŠÙ… ÙÙ‡Ø¯ Ø­Ø§Ù…Ø¯ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ</div>
  </div>

  <!-- Full analysis panel -->
  <div class="fullpanel" id="fullPanel" aria-hidden="true">
    <div class="inner">
      <div class="topbar">
        <div class="title" id="fpTitle">Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</div>
        <div class="pills">
          <button class="pill report" id="btnFieldReport" type="button" title="ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¬Ø§Ù„ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¬Ø§Ù„</button>
          <button class="pill plan" id="btnFieldPlan" type="button" title="Ø®Ø·Ø© ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø¬Ø§Ù„ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©">Ø®Ø·Ø© Ø§Ù„Ù…Ø¬Ø§Ù„</button>
          <button class="close" id="fpHome" type="button">Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© âŸµ</button>
          <button class="close" id="fpClose" type="button">Ø¥ØºÙ„Ø§Ù‚ âœ•</button>
        </div>
      </div>
      <div id="fpBody"></div>
    </div>
  </div>

  <!-- Metric image modal -->
  <div class="metricModal" id="metricModal" aria-hidden="true">
    <div class="sheet">
      <div class="bar">
        <strong id="metricModalTitle" style="color:#0b7e88">Ø¹Ø±Ø¶</strong>
        <button class="close" id="metricModalClose" type="button">Ø¥ØºÙ„Ø§Ù‚ âœ•</button>
      </div>
      <img id="metricModalImg" alt="Ø¹Ø±Ø¶"/>
    </div>
  </div>

  <!-- Evidence modal -->
  <div class="modal" id="eviModal" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true" aria-labelledby="eviTitle">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:6px">
        <h4 id="eviTitle" style="margin:0;text-align:center;color:#0b7e88">Ø¥Ø¶Ø§ÙØ© Ø´Ø§Ù‡Ø¯</h4>
        <button class="close" id="eviClose" type="button">âœ• Ø¥ØºÙ„Ø§Ù‚</button>
      </div>

      <div class="row" style="margin-bottom:8px">
        <div><label>Ø§Ø³Ù…/ÙˆØµÙ Ø§Ù„Ø´Ø§Ù‡Ø¯</label><input id="eviText" type="text" placeholder="Ù…Ø«Ø§Ù„: ØªØ­Ù„ÙŠÙ„ Ù†ØªØ§Ø¦Ø¬ ØµÙ1.."/></div>
        <div><label>Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label><select id="eviTerm"><option value="T1">Ø§Ù„Ø£ÙˆÙ„</option><option value="T2">Ø§Ù„Ø«Ø§Ù†ÙŠ</option></select></div>
        <div><label>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</label><select id="eviWeek"></select></div>
        <div><label>Ø§Ù„ØªØ§Ø±ÙŠØ® (Ù‡Ø¬Ø±ÙŠ)</label><input id="eviHijri" type="text" placeholder="1447/03/01"/></div>
      </div>

      <div class="row">
        <div><label>Ø±ÙØ¹ Ù…Ù„Ù (PDF/ØµÙˆØ±Ø©)</label><input id="eviFile" type="file" accept="application/pdf,image/*"/></div>
        <div><label>Ø±Ø§Ø¨Ø· Ø§Ù„Ø´Ø§Ù‡Ø¯ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label><input id="eviLink" type="url" placeholder="https://..."/></div>
        <div style="grid-column:span 2"><label>ÙŠØªØ¨Ø¹</label><input id="eviOwner" type="text" disabled/></div>
      </div>

      <div style="display:flex;gap:8px;margin-top:8px;justify-content:center">
        <button class="btn" id="eviSave" type="button">Ø­ÙØ¸ Ø§Ù„Ø´Ø§Ù‡Ø¯</button>
        <button class="btn light" id="eviCancel" type="button">Ø¥Ù„ØºØ§Ø¡</button>
      </div>
      <div class="small" style="margin-top:6px;text-align:center">* Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ ØªÙØ¹Ø±Ø¶ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­ÙØ¸ ÙˆÙŠÙ…ÙƒÙ† Ø­Ø°ÙÙ‡Ø§ Ù…Ù† Ø§Ù„ØµÙ.</div>
    </div>
  </div>

  <!-- Password mini-modal (Ù„Ù„Ø¥Ø¶Ø§ÙØ© ÙˆØ§Ù„Ø­Ø°Ù) -->
  <div class="modal" id="pwdModal" aria-hidden="true">
    <div class="sheet" style="max-width:420px">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:6px">
        <h4 style="margin:0;color:#0b7e88" id="pwdTitle">ØªØ­Ù‚Ù‚ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h4>
        <button class="close" id="pwdClose" type="button">âœ•</button>
      </div>
      <div>
        <label>Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <input id="pwdInput" type="password" placeholder="â€¢â€¢â€¢â€¢" />
      </div>
      <div style="display:flex;gap:8px;margin-top:10px;justify-content:center">
        <button class="btn" id="pwdOk" type="button">ØªØ£ÙƒÙŠØ¯</button>
        <button class="btn light" id="pwdCancel" type="button">Ø¥Ù„ØºØ§Ø¡</button>
      </div>
      <div style="text-align:center;color:#6f8e94;font-size:12px;margin-top:6px">* ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: 1447</div>
    </div>
  </div>

<script>
/* Links (ØªÙ… ØªØµØ­ÙŠØ­ Ø±Ø§Ø¨Ø· 2024) */
const SRC_2025='https://drive.google.com/file/d/1s0Rrv8gYkAbbZU3YudxWVC943iU18Df0/view?usp=drive_link';
const SRC_2024='https://drive.google.com/file/d/1YsfKzyjQl1SHuz24LLepZk8lb_ylf1Ar/view?usp=sharing';
const PLAN_LINK='https://drive.google.com/file/d/1O9o7rYNrtVW8gnOQLGd-lSQCiKq4eHne/view?usp=sharing';
const OPS_LINK='https://drive.google.com/file/d/1ItrZpaptSVaR_qFqMLhzHRAduIeJESa2/view?usp=sharing';

/* Helpers */
const fmt=v=>Number(v).toFixed(2);
function perfLevel(pct){
  if(pct>=90) return {name:'Ø§Ù„ØªÙ…ÙŠÙ‘Ø²', key:'excel',  color:getComputedStyle(document.documentElement).getPropertyValue('--lv-excel').trim()};
  if(pct>=75) return {name:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…', key:'progress',color:getComputedStyle(document.documentElement).getPropertyValue('--lv-progress').trim()};
  if(pct>=50) return {name:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚', key:'launch', color:getComputedStyle(document.documentElement).getPropertyValue('--lv-launch').trim()};
  return {name:'Ø§Ù„ØªÙ‡ÙŠØ¦Ø©', key:'ready', color:getComputedStyle(document.documentElement).getPropertyValue('--lv-ready').trim()};
}
function levelRowClass(arLevel){
  if(arLevel==='Ø§Ù„ØªÙ…ÙŠÙ‘Ø²'||arLevel==='Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…') return 'row-excellent';
  if(arLevel==='Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚') return 'row-verygood';
  if(arLevel==='Ø§Ù„ØªÙ‡ÙŠØ¦Ø©') return 'row-good';
  return 'row-medium';
}

/* Supabase */
const SUPABASE_URL  = 'https://vullbssjyyrnoyyxyebq.supabase.co';
const SUPABASE_ANON = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ1bGxic3NqeXlybm95eXh5ZWJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2OTQxODEsImV4cCI6MjA3NjI3MDE4MX0.D7o-dAyQbb2cjmp1ooZ0Mw9xoiih1JUarsEMZJVGfGc';
let supa = supabase.createClient(SUPABASE_URL, SUPABASE_ANON);
try{
  if(typeof window.supabase !== 'undefined' && SUPABASE_URL.startsWith('https')){
    supa = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON);
  }
}catch(e){ console.warn('Supabase init skipped:', e); }
</script>

<!-- ===== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ§Ù„Ù…Ø¤Ø´Ø±Ø§Øª (ÙƒÙ…Ø§ ÙˆÙÙ‘Ø±ØªÙ‡Ø§) ===== -->
<script>
const fields={
  management:{name:'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©',v2024:75.50,v2025:75.50,subs:[
    {id:'planning',name:'Ø§Ù„ØªØ®Ø·ÙŠØ·',v:54.00},{id:'lead',name:'Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©',v:72.75},
    {id:'soc',name:'Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ',v:57.25},{id:'dev',name:'Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ',v:60.25}
  ]},
  teaching:{name:'Ø§Ù„ØªØ¹Ù„ÙŠÙ… ÙˆØ§Ù„ØªØ¹Ù„Ù‘Ù…',v2024:80.75,v2025:81.50,subs:[
    {id:'assess',name:'ØªÙ‚ÙˆÙŠÙ… Ø§Ù„ØªØ¹Ù„Ù‘Ù…',v:82.75},{id:'exp',name:'Ø¨Ù†Ø§Ø¡ Ø®Ø¨Ø±Ø§Øª Ø§Ù„ØªØ¹Ù„Ù‘Ù…',v:76.75}
  ]},
  learning:{name:'Ù†ÙˆØ§ØªØ¬ Ø§Ù„ØªØ¹Ù„Ù‘Ù…',v2024:78.50,v2025:78.50,subs:[
    {id:'ach',name:'Ø§Ù„ØªØ­ØµÙŠÙ„ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ',v:80.25},{id:'socdev',name:'Ø§Ù„ØªØ·ÙˆØ± Ø§Ù„Ø´Ø®ØµÙŠ ÙˆØ§Ù„ØµØ­ÙŠ ÙˆØ§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ',v:86.25}
  ]},
  environment:{name:'Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©',v2024:64.00,v2025:62.25,subs:[
    {id:'safety',name:'Ø§Ù„Ø£Ù…Ù† ÙˆØ§Ù„Ø³Ù„Ø§Ù…Ø©',v:79.00},{id:'building',name:'Ø§Ù„Ù…Ø¨Ù†Ù‰ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ',v:71.50}
  ]}
};

const detailed={
  management:[
    {code:'1-1-1-1',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:81.75,indicator:'ØªØ¶Ø¹ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø®Ø·Ø© ØªØ´ØºÙŠÙ„ÙŠØ© Ù…ÙƒØªÙ…Ù„Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙˆÙÙ‚ Ø£Ù‡Ø¯Ø§Ù ØªØ·ÙˆÙŠØ±ÙŠØ© Ù…Ø­Ø¯Ø¯Ø©',improve:'ØªØ·ÙˆÙŠØ± Ø®Ø·Ø© ØªØ´ØºÙŠÙ„ÙŠØ© Ù…Ø±Ù†Ø© Ø¨Ø£Ù‡Ø¯Ø§Ù Ø·Ù…ÙˆØ­Ø© ÙˆØ¨Ø±Ø§Ù…Ø¬ ÙˆÙ…Ø¨Ø§Ø¯Ø±Ø§Øª ÙˆÙ…Ø¤Ø´Ø±Ø§Øª Ø£Ø¯Ø§Ø¡ ÙˆÙ…Ù‡Ø§Ù… ÙˆÙ…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª Ù…ÙØ²Ù…Ù‘Ù†Ø©ØŒ ÙˆØ®Ø·Ø· Ø§Ø³ØªØ¯Ø§Ù…Ø© ÙˆØªØ­Ø³ÙŠÙ†.',evidence:'Ø®Ø·Ø© ØªØ´ØºÙŠÙ„ÙŠØ© Ù…Ø¹ØªÙ…Ø¯Ø© + Ù…Ø­Ø¶Ø± Ù„Ø¬Ù†Ø© Ø§Ù„Ø®Ø·Ø© + Ù…ØµÙÙˆÙØ© KPI'},
    {code:'2-1-1-1',level:'Ø§Ù„ØªÙ‡ÙŠØ¦Ø©',perf:42.00,indicator:'ØªØªØ§Ø¨Ø¹ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ØªÙ†ÙÙŠØ° Ø®Ø·ØªÙ‡Ø§ ÙˆØªØ·ÙˆØ±Ù‡Ø§ Ø¨Ù…Ø§ ÙŠØ¶Ù…Ù† ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‡Ø¯Ø§ÙÙ‡Ø§',improve:'Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªÙ†ÙÙŠØ° ÙˆØªÙ‚ÙˆÙŠÙ…Ù‡ Ø¨Ø§Ù†ØªØ¸Ø§Ù… ÙˆÙÙ‚ Ù…Ø¤Ø´Ø±Ø§Øª ÙˆØ§Ø¶Ø­Ø©ØŒ ÙˆØªØ·ÙˆÙŠØ± Ø§Ù„Ø®Ø·Ø© Ù„Ø¶Ù…Ø§Ù† ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù.',evidence:'ØªÙ‚Ø§Ø±ÙŠØ± Ù…ØªØ§Ø¨Ø¹Ø© Ø´Ù‡Ø±ÙŠØ© + Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª Ù…ØªØ§Ø¨Ø¹Ø© + Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ØªØµØ­ÙŠØ­'},
    {code:'1-1-2-1',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:76.25,indicator:'ØªØ¹Ø²Ø² Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© ÙˆØ§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ©',improve:'ØºØ±Ø³ Ø§Ù„Ù‚ÙŠÙ… ÙˆØ§Ù„Ù‡ÙˆÙŠØ© ÙˆØªØ¹Ø²ÙŠØ² Ø§Ù„Ø§Ù†ØªÙ…Ø§Ø¡ Ø¹Ø¨Ø± Ø£Ù†Ø´Ø·Ø© ÙˆÙ…Ù†Ø§Ø³Ø¨Ø§Øª ÙˆØ¨Ø±Ø§Ù…Ø¬ Ù…Ø¨ØªÙƒØ±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ÙˆÙ…Ø¹ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹.',evidence:'Ø®Ø·Ø© Ù…Ù†Ø§Ø³Ø¨Ø§Øª ÙˆØ·Ù†ÙŠØ© + ØªÙˆØ«ÙŠÙ‚ Ø§Ù„ØªÙ†ÙÙŠØ° + Ø§Ø³ØªØ¨Ø§Ù†Ø§Øª Ø£Ø«Ø±'},
    {code:'1-2-1-2',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:81.25,indicator:'ØªÙ„ØªØ²Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø¨Ù‚ÙŠÙ… Ù…Ù‡Ù†Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… ÙˆØ£Ø®Ù„Ø§Ù‚ÙŠØ§ØªÙ‡Ø§',improve:'ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ ÙˆØ£Ø®Ù„Ø§Ù‚ÙŠØ§Øª Ø§Ù„Ù…Ù‡Ù†Ø© ÙˆØ§Ù„ØªÙˆØ¹ÙŠØ© Ø¨Ø£Ø³Ø§Ù„ÙŠØ¨ Ù…Ø¨ØªÙƒØ±Ø© ÙˆØ¯Ø¹Ù… Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©.',evidence:'ØªØ¹Ù…ÙŠÙ… Ø§Ù„Ù…ÙŠØ«Ø§Ù‚ + ØªÙˆÙ‚ÙŠØ¹Ø§Øª Ø§Ø·Ù„Ø§Ø¹ + Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªÙˆØ¹ÙˆÙŠ'},
    {code:'1-2-1-3',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:83.00,indicator:'ØªÙˆÙØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ù…Ù†Ø§Ø®Ù‹Ø§ Ø¢Ù…Ù†Ù‹Ø§ Ù„Ù„ØªØ¹Ù„Ù… ÙˆØ§Ù„Ù†Ù…Ùˆ Ù†ÙØ³ÙŠÙ‹Ù‘Ø§ ÙˆØ§Ø¬ØªÙ…Ø§Ø¹ÙŠÙ‹Ù‘Ø§',improve:'Ù…Ù†Ø§Ø® Ø¢Ù…Ù† Ù„Ù„Ø­ÙˆØ§Ø± ÙˆØ§Ù„ØªØ¹Ø§ÙˆÙ† ÙˆØ§Ù„Ø§Ø­ØªØ±Ø§Ù…ØŒ ÙˆØ¨Ø±Ø§Ù…Ø¬ Ø¹Ù„Ø§Ø¬ÙŠØ©/ÙˆÙ‚Ø§Ø¦ÙŠØ© Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØªÙ†Ù…Ø±.',evidence:'Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¥Ø±Ø´Ø§Ø¯ + Ø³Ø¬Ù„ Ø­Ø§Ù„Ø§Øª ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© + Ø­Ù…Ù„Ø§Øª ØªÙˆØ¹ÙŠØ©'},
    {code:'1-2-1-4',level:'Ø§Ù„ØªÙ…ÙŠÙ‘Ø²',perf:94.75,indicator:'ØªÙ†Ø´Ø± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø³Ù„ÙˆÙƒ ÙˆØ§Ù„Ù…ÙˆØ§Ø¸Ø¨Ø©ØŒ ÙˆØªØªØ§Ø¨Ø¹ ØªØ·Ø¨ÙŠÙ‚Ù‡Ø§',improve:'Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙÙŠ Ù†Ø´Ø± Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ ÙˆØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø§Ù†ØªØ¸Ø§Ù… Ø¨Ø£Ø³Ø§Ù„ÙŠØ¨ Ù…Ø¨ØªÙƒØ±Ø©.',evidence:'Ù„Ø§Ø¦Ø­Ø© Ù…Ù†Ø´ÙˆØ±Ø© + Ø¯Ù„Ø§Ø¦Ù„ Ù†Ø´Ø± + ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù†Ø¶Ø¨Ø§Ø·'},
    {code:'5-1-2-1',level:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚',perf:62.50,indicator:'ØªÙˆÙØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø¨Ø±Ø§Ù…Ø¬ ÙˆØ£Ù†Ø´Ø·Ø© ØªØ±Ø¨ÙˆÙŠØ© Ø¯Ø§Ø¹Ù…Ø© Ù„Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ',improve:'Ø£Ù†Ø´Ø·Ø© Ø¹Ù„Ø§Ø¬ÙŠØ©/ÙˆÙ‚Ø§Ø¦ÙŠØ© Ø´Ø§Ù…Ù„Ø© Ù…Ø±ØªØ¨Ø·Ø© Ø¨ØªØ´Ø®ÙŠØµ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§ØªØŒ Ù…ØªØ§Ø¨Ø¹Ø© ÙˆØªØ·ÙˆÙŠØ± ÙˆØ§Ø³ØªØ«Ù…Ø§Ø± Ø§Ù„Ø´Ø±Ø§ÙƒØ§Øª.',evidence:'Ø®Ø·Ø© ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø³Ù„ÙˆÙƒ + Ø£Ø¯ÙˆØ§Øª ØªØ´Ø®ÙŠØµ + Ù‚ÙŠØ§Ø³ Ø£Ø«Ø±'},
    {code:'6-1-2-1',level:'Ø§Ù„ØªÙ‡ÙŠØ¦Ø©',perf:45.00,indicator:'Ø¨Ø±Ø§Ù…Ø¬ ÙˆØ£Ù†Ø´Ø·Ø© Ø¥Ø«Ø±Ø§Ø¦ÙŠØ© ØºÙŠØ± ØµÙÙŠØ© Ù„ØªØ·ÙˆÙŠØ± Ù…ÙˆØ§Ù‡Ø¨ Ø§Ù„Ù…ØªØ¹Ù„Ù…ÙŠÙ† ÙˆØªÙ‡ÙŠØ¦ØªÙ‡Ù… Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„',improve:'Ø£Ø³Ø§Ù„ÙŠØ¨ ÙƒØ´Ù Ø§Ù„Ù…ÙˆÙ‡Ø¨Ø© ÙˆØªØ­ÙÙŠØ² Ù…Ù‚Ø§ÙŠÙŠØ³ Ù…ÙˆÙ‡Ø¨Ø© ÙˆØ£Ù†Ø´Ø·Ø© Ø¥Ø«Ø±Ø§Ø¦ÙŠØ© Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª ÙˆØ­ÙˆØ§ÙØ² ÙˆÙ…Ø´Ø§Ø±ÙƒØ§Øª ØªÙ†Ø§ÙØ³ÙŠØ©.',evidence:'Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…ÙˆÙ‡ÙˆØ¨ÙŠÙ† + Ù…Ø´Ø§Ø±ÙƒØ§Øª Ù…ÙˆÙ‡Ø¨Ø© + Ø®Ø·Ø© Ø¥Ø«Ø±Ø§Ø¦ÙŠØ©'},
    {code:'1-3-1-1',level:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚',perf:68.25,indicator:'ØªØ¹Ø²Ø² Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ© ÙˆØ§Ù„ØªØ¹Ø§ÙˆÙ† ÙÙŠ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ',improve:'Ù…Ù‡Ø§Ù… ØªØ´Ø¬Ø¹ Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø±ÙˆØ­ Ø§Ù„ÙØ±ÙŠÙ‚ ÙˆØªØ¹Ø²ÙŠØ² Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠØ© ÙˆÙ…ØªØ§Ø¨Ø¹Ø© ÙˆØ§Ø³ØªØ¯Ø§Ù…Ø© ÙˆØªØ·ÙˆÙŠØ±.',evidence:'Ù…Ø­Ø§Ø¶Ø± ÙØ±Ù‚/PLC + ØªÙˆØ²ÙŠØ¹ Ø£Ø¯ÙˆØ§Ø± + Ø§Ø³ØªØ¨Ø§Ù†Ø© ØªÙ…Ø§Ø³Ùƒ'},
    {code:'2-1-3-1',level:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚',perf:55.25,indicator:'ØªØ¹Ø²Ø² Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø£Ø³Ø±Ø© ÙÙŠ ØªØ¹Ù„Ù… Ø£Ø¨Ù†Ø§Ø¦Ù‡Ù… ÙˆØ§Ù„ØªØ­Ø¶ÙŠØ± Ù„Ù…Ø³ØªÙ‚Ø¨Ù„Ù‡Ù…',improve:'ÙØ±Øµ ØªÙˆØ§ØµÙ„ ÙØ¹Ù‘Ø§Ù„Ø© Ù…Ø¹ Ø§Ù„Ø£Ø³Ø±Ø© ÙˆØ¨Ø±Ø§Ù…Ø¬ ØªÙˆØ¹ÙˆÙŠØ© Ù…Ø¨ØªÙƒØ±Ø© ÙˆØ¥Ø´Ø±Ø§ÙƒÙ‡Ù… ÙÙŠ Ø§Ù„ØªØ­Ø¶ÙŠØ± Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ÙˆØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø§Øª.',evidence:'Ù„Ù‚Ø§Ø¡Ø§Øª Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ± + Ù‚Ù†ÙˆØ§Øª ØªÙˆØ§ØµÙ„ + ØªØºØ°ÙŠØ© Ø±Ø§Ø¬Ø¹Ø©'},
    {code:'3-1-3-1',level:'Ø§Ù„ØªÙ‡ÙŠØ¦Ø©',perf:39.75,indicator:'ØªØ¹Ø²Ø² Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø´Ø±Ø§ÙƒØ© Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ÙŠØ© Ù„Ø¯Ø¹Ù… Ø§Ù„ØªØ¹Ù„Ù… ÙˆØ§Ù„ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ',improve:'ØªÙˆØ§ØµÙ„ Ù…ØªÙ†ÙˆØ¹ Ù…Ø¹ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ØŒ Ø§Ø³ØªØ«Ù…Ø§Ø± Ø¥Ù…ÙƒØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª Ø§Ù„ÙˆØ·Ù†ÙŠØ©ØŒ ÙØ¹Ø§Ù„ÙŠØ§Øª ØªÙˆØ¹ÙˆÙŠØ© ÙˆØ¥ØªØ§Ø­Ø© Ø§Ù„Ø¥Ù…ÙƒØ§Ù†Ø§Øª.',evidence:'Ø®Ø·Ø§Ø¨Ø§Øª/Ø§ØªÙØ§Ù‚ÙŠØ§Øª Ø´Ø±Ø§ÙƒØ© + ÙØ¹Ø§Ù„ÙŠØ§Øª + Ù‚ÙŠØ§Ø³ Ø£Ø«Ø±'},
    {code:'1-1-4-1',level:'Ø§Ù„ØªÙ‡ÙŠØ¦Ø©',perf:24.75,indicator:'ØªØ´Ø¬Ø¹ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ù…Ù†Ø³ÙˆØ¨ÙŠÙ‡Ø§ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø®ØµØ© Ø§Ù„Ù…Ù‡Ù†ÙŠØ©',improve:'Ø¨Ø±Ø§Ù…Ø¬ ØªÙˆØ¹ÙˆÙŠØ©/ØªØ­ÙÙŠØ²ÙŠØ© ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆÙÙ‚ Ø§Ù„Ø±ØªØ¨ Ø§Ù„Ù…Ù‡Ù†ÙŠØ©.',evidence:'Ø³Ø¬Ù„ Ø§Ù„Ø±Ø®Øµ + Ø®Ø·Ø© ØªØ­ÙÙŠØ²ÙŠØ© + Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª'},
    {code:'1-4-1-2',level:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚',perf:53.00,indicator:'ØªØ¯Ø¹Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù‡Ù†ÙŠ ÙˆÙÙ‚ Ù†ØªØ§Ø¦Ø¬ ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ø­ØªÙŠØ§Ø¬Ø§ØªÙ‡Ù…',improve:'Ø®Ø·Ø© ØªØ·ÙˆÙŠØ± Ù…Ù‡Ù†ÙŠ Ù…Ø±ØªØ¨Ø·Ø© Ø¨ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø£Ø¯Ø§Ø¡ØŒ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªÙ†ÙÙŠØ° ÙˆÙ‚ÙŠØ§Ø³ Ø§Ù„Ø£Ø«Ø± ÙˆØªØ´Ø¬ÙŠØ¹ PLC ÙˆØ§Ù„Ø¨Ø­ÙˆØ« Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¦ÙŠØ©.',evidence:'Ø®Ø·Ø© ØªØ¯Ø±ÙŠØ¨ Ø³Ù†ÙˆÙŠØ© + Ø³Ø¬Ù„Ø§Øª Ø­Ø¶ÙˆØ± + Ù‚ÙŠØ§Ø³ Ø£Ø«Ø±'},
    {code:'3-1-4-1',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:79.25,indicator:'ØªØ·Ø¨Ù‚ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø°Ø§ØªÙŠÙ‘ Ø§Ù„Ù…Ø¨Ù†ÙŠÙ‘ Ø¹Ù„Ù‰ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù‡ÙŠØ¦Ø©',improve:'ØªÙ†ÙÙŠØ° Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø°Ø§ØªÙŠ ÙˆÙÙ‚ Ø§Ù„Ø¥Ø·Ø§Ø±ØŒ Ù†Ø´Ø± Ø§Ù„Ø«Ù‚Ø§ÙØ©ØŒ Ø¥Ø´Ø±Ø§Ùƒ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØŒ ÙˆØ®Ø·Ø© Ø·Ù…ÙˆØ­Ø© Ù„Ù†Ù‚Ù„ Ø§Ù„Ù…Ø¹Ø±ÙØ©.',evidence:'Ø£Ø¯Ø§Ø© ÙˆØªÙ‚Ø§Ø±ÙŠØ± ØªÙ‚ÙˆÙŠÙ… Ø°Ø§ØªÙŠ + Ø®Ø·Ø© ØªØ­Ø³ÙŠÙ† Ù…Ø´ØªÙ‚Ø©'},
    {code:'1-4-1-4',level:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚',perf:74.00,indicator:'ØªÙ†ÙØ° Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø®Ø·Ø© Ù„Ù„ØªØ­Ø³ÙŠÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… ÙˆØªØªØ§Ø¨Ø¹Ù‡Ø§',improve:'ØªØ·ÙˆÙŠØ± Ø®Ø·Ø© ØªØ­Ø³ÙŠÙ† Ø¨Ø£ÙˆÙ„ÙˆÙŠØ§Øª ØªØ¹Ø§Ù„Ø¬ Ø¬ÙˆØ§Ù†Ø¨ Ù…Ø¤Ø«Ø±Ø© ÙÙŠ Ù†ÙˆØ§ØªØ¬ Ø§Ù„ØªØ¹Ù„Ù… ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªÙ†ÙÙŠØ°.',evidence:'Ø®Ø·Ø© ØªØ­Ø³ÙŠÙ† Ù…Ø¹ØªÙ…Ø¯Ø© + ØªÙ‚Ø§Ø±ÙŠØ± ØªÙ‚Ø¯Ù… + Ù…ÙˆØ§Ø¡Ù…Ø© ØªØ´ØºÙŠÙ„ÙŠØ©'}
  ],
  teaching:[
    {code:'2-1-1-2',level:'Ø§Ù„ØªÙ…ÙŠÙ‘Ø²',perf:97.75,indicator:'ØªØ¯Ø¹Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù†Ø§Ù‡Ø¬ ÙˆÙÙ‚ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©',improve:'Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙÙŠ ØªÙˆÙÙŠØ± Ø£Ù†Ø´Ø·Ø© ÙˆÙ…ØµØ§Ø¯Ø± Ù…Ø¨ØªÙƒØ±Ø© ØªØ¯Ø¹Ù… ØªØ¹Ù„Ù… Ø§Ù„Ù…Ø¹Ø§Ø±Ù/Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª ÙˆØ§Ù„Ù‚ÙŠÙ… ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø¹Ø§Ù„ÙŠØ©.',evidence:'Ø®Ø·Ø· ØªÙˆØ²ÙŠØ¹ + Ø³Ø¬Ù„Ø§Øª ØªØ·Ø¨ÙŠÙ‚ + Ø¯Ø±ÙˆØ³ Ù†Ù…ÙˆØ°Ø¬ÙŠØ©'},
    {code:'2-2-1-3',level:'Ø§Ù„ØªÙ…ÙŠÙ‘Ø²',perf:93.25,indicator:'ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„ØªØºØ°ÙŠØ© Ø§Ù„Ø±Ø§Ø¬Ø¹Ø© Ù„Ù„Ù…ØªØ¹Ù„Ù…ÙŠÙ† Ø¨Ø§Ù†ØªØ¸Ø§Ù…',improve:'Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙÙŠ Ø§Ù„ØªØºØ°ÙŠØ© Ø§Ù„Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙÙˆØ±ÙŠØ© ÙˆØ§Ù„Ø¨Ù†Ù‘Ø§Ø¡Ø© Ø¨Ø·Ø±Ù‚ Ù…ØªÙ†ÙˆØ¹Ø© Ù„Ø¯Ø¹Ù… Ø§Ù„ØªØ¹Ù„Ù… ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡.',evidence:'Ù†Ù…Ø§Ø°Ø¬ ØªØºØ°ÙŠØ© Ø±Ø§Ø¬Ø¹Ø© + Ù…ØªØ§Ø¨Ø¹Ø© ÙØ±Ø¯ÙŠØ©'},
    {code:'8-1-1-2',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:88.50,indicator:'ØªÙ†Ù…ÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø§Ø·ÙÙŠØ© ÙˆØ§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© Ù„Ø¯Ù‰ Ø§Ù„Ù…ØªØ¹Ù„Ù…ÙŠÙ†',improve:'Ø¨ÙŠØ¦Ø© ØªØ¹Ù„Ù… ØªØ¹Ø²Ø² Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø¹ÙˆØ§Ø·Ù ÙˆØ§Ù„Ø«Ù‚Ø© Ø¨Ø§Ù„Ù†ÙØ³ ÙˆØ§Ù„ØªØ¹Ø§ÙˆÙ† ÙˆØ§Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„Ø­ÙˆØ§Ø± ÙˆØ§Ù„Ø§Ø­ØªØ±Ø§Ù… Ø§Ù„Ù…ØªØ¨Ø§Ø¯Ù„.',evidence:'Ø¨Ø±Ø§Ù…Ø¬ SEL + Ø¬Ù„Ø³Ø§Øª Ø¥Ø±Ø´Ø§Ø¯ + Ø§Ø³ØªØ¨Ø§Ù†Ø§Øª Ù…Ù‡Ø§Ø±ÙŠØ©'},
    {code:'2-1-2-2',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:79.50,indicator:'ØªØ­Ù„Ù„ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… ÙˆØªÙˆØ¸ÙÙ‡Ø§ ÙÙŠ ØªØ­Ø³ÙŠÙ† Ù†ÙˆØ§ØªØ¬ Ø§Ù„ØªØ¹Ù„Ù…',improve:'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØªÙØ³ÙŠØ±Ù‡Ø§ ÙˆØ§ØªØ®Ø§Ø° Ù‚Ø±Ø§Ø±Ø§Øª ÙˆØ¨Ù†Ø§Ø¡ Ø®Ø·Ø· Ø¹Ù„Ø§Ø¬ÙŠØ©/Ø¥Ø«Ø±Ø§Ø¦ÙŠØ© Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©.',evidence:'ØªÙ‚Ø§Ø±ÙŠØ± ØªØ­Ù„ÙŠÙ„ + Ø®Ø·Ø· Ø¹Ù„Ø§Ø¬/Ø¥Ø«Ø±Ø§Ø¡ + Ù…ØªØ§Ø¨Ø¹Ø© ØªÙ‚Ø¯Ù…'},
    {code:'3-1-1-2',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:79.25,indicator:'ØªÙ†ÙˆØ¹ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ÙÙŠ Ø¥Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ³',improve:'Ø®Ø¨Ø±Ø§Øª ØªØ¹Ù„Ù… Ø«Ø±ÙŠØ© ØªØ´Ø¬Ø¹ Ø§Ù„Ø¨Ø­Ø«/Ø§Ù„ØªØ¬Ø±ÙŠØ¨ ÙˆØªØ±Ø§Ø¹ÙŠ Ø§Ù„ÙØ±ÙˆÙ‚ ÙˆØªÙ„Ø¨ÙŠ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª.',evidence:'Ø®Ø·Ø· Ø¯Ø±ÙˆØ³ Ù…ØªÙ†ÙˆØ¹Ø© + Ø²ÙŠØ§Ø±Ø§Øª ØµÙÙŠØ©'},
    {code:'6-1-1-2',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:77.50,indicator:'ØªÙ†Ù…ÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¦ÙŠØ© ÙˆØ§Ù„Ø¹Ø¯Ø¯ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©',improve:'ØªØ¹Ø²ÙŠØ² Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©/Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙˆØ§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø¯Ø¯ÙŠØ© Ø¹Ø¨Ø± Ø£Ù†Ø´Ø·Ø© ØµÙÙŠØ© ÙˆÙ„Ø§ØµÙÙŠØ© ÙˆØ®Ø·Ø© Ù…Ø±ÙƒØ²Ø© Ø·ÙˆÙŠÙ„Ø© Ø§Ù„Ù…Ø¯Ù‰.',evidence:'Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ØªØ´Ø®ÙŠØµÙŠØ© + Ø®Ø·Ø© Ø¹Ù„Ø§Ø¬ + ØªØªØ¨Ø¹ ÙØ±Ø¯ÙŠ'},
    {code:'2-2-1-1',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:77.25,indicator:'ØªÙ‚ÙˆÙ‘Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ØªØ¹Ù„Ù…ÙŠÙ† Ø¨Ø£Ø³Ø§Ù„ÙŠØ¨ Ù…ØªÙ†ÙˆØ¹Ø©',improve:'ØªØ´Ø®ÙŠØµÙŠ/ØªÙƒÙˆÙŠÙ†ÙŠ/Ø®ØªØ§Ù…ÙŠ ÙˆÙ…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…ØªØ¹Ù„Ù…ÙŠÙ† ÙÙŠ ØªÙ‚ÙˆÙŠÙ… Ø£Ø¯Ø§Ø¦Ù‡Ù….',evidence:'Ø¨Ù†Ùƒ Ø£Ø³Ø¦Ù„Ø© + Ø£Ø¯ÙˆØ§Øª ØªÙ‚ÙˆÙŠÙ… + Ù…Ù„ÙØ§Øª Ø¥Ù†Ø¬Ø§Ø²'},
    {code:'2-1-1-10',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:77.25,indicator:'ØªØ¹Ø²Ø² Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø¯Ø§ÙØ¹ÙŠØ© Ø§Ù„Ù…ØªØ¹Ù„Ù…ÙŠÙ†',improve:'Ø¨ÙŠØ¦Ø© ØªØ¹Ù„Ù… ØªØ­Ù‚Ù‚ Ø§Ù„Ø±ÙØ§Ù‡ ÙˆØªØ«ÙŠØ± Ø§Ù„ÙØ¶ÙˆÙ„ ÙˆØªØ­ÙØ² ÙˆÙÙ‚ Ø§Ù„Ù…ÙŠÙˆÙ„.',evidence:'Ø¨Ø±Ø§Ù…Ø¬ ØªØ­ÙÙŠØ²ÙŠØ© + Ù…Ø³Ø§Ø¨Ù‚Ø§Øª + Ø¨Ø·Ø§Ù‚Ø§Øª ØªØ´Ø¬ÙŠØ¹'},
    {code:'1-1-1-2',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:76.75,indicator:'ÙØ±Øµ Ù…ØªÙƒØ§ÙØ¦Ø© Ù„Ù„ØªØ¹Ù„Ù…',improve:'Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© ÙˆØ§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø´Ø§Ù…Ù„.',evidence:'IEP + ØªÙƒÙŠÙŠÙØ§Øª + Ù‚ÙˆØ§Ø¦Ù… Ù…ÙˆÙ‡ÙˆØ¨ÙŠÙ†'},
    {code:'7-1-1-2',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:75.25,indicator:'ØªÙ†Ù…ÙŠØ© Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ø¹Ù„ÙŠØ§',improve:'Ø£Ù†Ø´Ø·Ø© Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù„Ø§Ø³ØªÙ†ØªØ§Ø¬ ÙˆØ§Ù„ØªÙ‚ÙˆÙŠÙ… ÙˆØ§Ù„Ø¥Ø¨Ø¯Ø§Ø¹.',evidence:'Ù…Ù†ØªØ¬Ø§Øª ØªØ¹Ù„Ù… + Rubrics ØªÙÙƒÙŠØ±'},
    {code:'4-1-1-2',level:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚',perf:69.75,indicator:'ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ',improve:'Ø¯Ù…Ø¬ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ØµÙÙŠ ÙˆØ§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.',evidence:'Ù…Ù†ØµØ© + Ø¯Ø±ÙˆØ³ Ø±Ù‚Ù…ÙŠØ© + ØªÙ‚Ø§Ø±ÙŠØ± Ø¯Ø®ÙˆÙ„'},
    {code:'5-1-1-2',level:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚',perf:62.00,indicator:'Ø£Ù†Ø´Ø·Ø© ØªØ¹Ù„Ù… ØªØ·Ø¨ÙŠÙ‚ÙŠØ©',improve:'Ø±Ø¨Ø· Ø§Ù„Ø®Ø¨Ø±Ø§Øª Ø¨Ø§Ù„ÙˆØ§Ù‚Ø¹ ÙˆØªØ´Ø¬ÙŠØ¹ Ø§Ù„Ø§Ø³ØªÙ‚ØµØ§Ø¡.',evidence:'Ù…Ø´Ø§Ø±ÙŠØ¹/Ù…Ù‡Ø§Ù… Ø£Ø¯Ø§Ø¦ÙŠØ© + Ø³Ù„Ø§Ù„Ù… ØªÙ‚Ø¯ÙŠØ±'},
    {code:'9-1-1-2',level:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚',perf:60.75,indicator:'Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ©',improve:'ØªØ¹Ø²ÙŠØ² Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙ‚Ù†ÙŠØ© ÙˆØ§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.',evidence:'ØªØ¯Ø±ÙŠØ¨Ø§Øª ØªÙ‚Ù†ÙŠØ© + Ù…Ù†ØªØ¬Ø§Øª Ø±Ù‚Ù…ÙŠØ©'}
  ],
  learning:[
    {code:'3-2-1-1',level:'Ø§Ù„ØªÙ…ÙŠÙ‘Ø²',perf:95.50,indicator:'Ø§Ø¹ØªØ²Ø§Ø² Ø¨Ø§Ù„Ù‚ÙŠÙ… ÙˆØ§Ù„Ù‡ÙˆÙŠØ©',improve:'ØªØ¹Ø²ÙŠØ² Ø§Ù„Ù‚ÙŠÙ… ÙˆØ§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.',evidence:'ÙØ¹Ø§Ù„ÙŠØ§Øª ÙˆØ·Ù†ÙŠØ© + Ø£Ø¹Ù…Ø§Ù„ Ø·Ù„Ø§Ø¨ÙŠØ©'},
    {code:'5-1-2-3',level:'Ø§Ù„ØªÙ…ÙŠÙ‘Ø²',perf:94.00,indicator:'Ø§Ù†Ø¶Ø¨Ø§Ø· Ù…Ø¯Ø±Ø³ÙŠ',improve:'Ø¨Ø±Ø§Ù…Ø¬ Ù…ØªÙ†ÙˆØ¹Ø© ÙˆÙ…Ø¨ØªÙƒØ±Ø©.',evidence:'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù†Ø¶Ø¨Ø§Ø· + Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø¶ÙˆØ±'},
    {code:'3-2-1-2',level:'Ø§Ù„ØªÙ…ÙŠÙ‘Ø²',perf:91.75,indicator:'Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ© Ù†Ø­Ùˆ Ø§Ù„Ø°Ø§Øª',improve:'ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø±ÙØ§Ù‡ ÙˆØ§Ù„Ø³Ø¹Ø§Ø¯Ø©.',evidence:'Ø¨Ø±Ø§Ù…Ø¬ Ø±ÙØ§Ù‡ + Ø¬Ù„Ø³Ø§Øª Ø¥Ø±Ø´Ø§Ø¯'},
    {code:'7-1-2-3',level:'Ø§Ù„ØªÙ…ÙŠÙ‘Ø²',perf:91.75,indicator:'Ø§Ø¹ØªØ²Ø§Ø² Ø¨Ø§Ù„Ø«Ù‚Ø§ÙØ© ÙˆØ§Ø­ØªØ±Ø§Ù… Ø§Ù„ØªÙ†ÙˆØ¹',improve:'ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø«ÙˆØ§Ø¨Øª Ø§Ù„ÙˆØ·Ù†ÙŠØ© ÙˆØ§Ø­ØªØ±Ø§Ù… Ø§Ù„ØªÙ†ÙˆØ¹.',evidence:'Ù…Ù†ØªØ¬Ø§Øª Ø«Ù‚Ø§ÙÙŠØ© + ÙØ¹Ø§Ù„ÙŠØ§Øª'},
    {code:'6-1-2-3',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:84.25,indicator:'Ø¨Ø­Ø« ÙˆØªØ¹Ù„Ù… Ø°Ø§ØªÙŠ',improve:'Ù…Ù‡Ø§Ù… Ø£Ø¯Ø§Ø¦ÙŠØ© ÙˆØ¥Ø¯Ø§Ø±Ø© ÙˆÙ‚Øª ÙˆØªÙˆØ¸ÙŠÙ Ø§Ù„ØªÙ‚Ù†ÙŠØ©.',evidence:'Ù…Ø´Ø§Ø±ÙŠØ¹ + Rubrics Ø¨Ø­ÙˆØ«'},
    {code:'2-1-1-3',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:82.94,indicator:'Ù†ØªØ§Ø¦Ø¬ Ù…ØªÙ‚Ø¯Ù…Ø© ÙÙŠ Ø§Ù„Ù‚Ø¯Ø±Ø§Øª',improve:'ØªØ¹Ø²ÙŠØ² Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù„Ø§Ø³ØªØ¯Ù„Ø§Ù„ ÙˆØ§Ù„Ù…Ù†Ø·Ù‚.',evidence:'Ù†ØªØ§Ø¦Ø¬ + Ø®Ø·Ø© ØªØ¯Ø±ÙŠØ¨ + Ù…Ø­Ø§ÙƒØ§Ø©'},
    {code:'3-1-2-3',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:82.50,indicator:'Ù…Ù…Ø§Ø±Ø³Ø§Øª ØµØ­ÙŠØ©',improve:'Ù†Ø´Ø§Ø· Ø¨Ø¯Ù†ÙŠ ÙˆØºØ°Ø§Ø¡ ØµØ­ÙŠ.',evidence:'Ø®Ø·Ø© ØµØ­Ø© + Ø³Ø¬Ù„Ø§Øª'},
    {code:'1-1-1-3',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:79.04,indicator:'Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªØ­ØµÙŠÙ„ÙŠØ©',improve:'ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª ÙˆØ§Ù„Ø§Ø³ØªØ¹Ø¯Ø§Ø¯.',evidence:'Ù†ØªØ§Ø¦Ø¬ + Ø®Ø·Ø© Ø±ÙØ¹ + ØªÙ‚ÙˆÙŠØ©'},
    {code:'4-1-2-3',level:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚',perf:63.25,indicator:'Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ø¬ØªÙ…Ø¹ÙŠØ© ÙˆØªØ·ÙˆØ¹',improve:'Ø¨Ø±Ø§Ù…Ø¬ Ù†ÙˆØ¹ÙŠØ© ØªØ¹Ø²Ø² Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©.',evidence:'Ù…Ù†ØµØ© ØªØ·ÙˆØ¹ + Ø´Ù‡Ø§Ø¯Ø§Øª'}
  ],
  environment:[
    {code:'4-2-1-2',level:'Ø§Ù„ØªÙ…ÙŠÙ‘Ø²',perf:97.00,indicator:'ØµÙŠØ§Ù†Ø© Ù…Ù†ØªØ¸Ù…Ø© Ù„Ù„Ù…Ø¨Ù†Ù‰',improve:'Ø§Ø³ØªÙ…Ø±Ø§Ø± Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØµÙŠØ§Ù†Ø©.',evidence:'Ø£ÙˆØ§Ù…Ø± Ø¹Ù…Ù„ + Ø¬Ø¯Ø§ÙˆÙ„ ÙˆÙ‚Ø§Ø¦ÙŠØ©'},
    {code:'4-2-1-3',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:79.50,indicator:'Ù†Ø¸Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù†Ù‰',improve:'Ù…ØªØ§Ø¨Ø¹Ø© ÙˆØªÙˆÙÙŠØ± Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù†Ø¸Ø§ÙØ©.',evidence:'Ø¹Ù‚Ø¯ Ù†Ø¸Ø§ÙØ© + Ø¨Ø·Ø§Ù‚Ø§Øª Ù…ØªØ§Ø¨Ø¹Ø©'},
    {code:'2-1-1-4',level:'Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…',perf:79.00,indicator:'Ù…Ù„Ø§Ø¡Ù…Ø© Ø§Ù„ÙØµÙˆÙ„ ÙˆØ§Ù„Ù…Ø¹Ø§Ù…Ù„',improve:'ØªÙ†Ø¸ÙŠÙ… ÙˆØªØ¬Ù‡ÙŠØ² ÙˆÙÙ‚ Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±.',evidence:'Ø¬Ø±Ø¯ ØªØ¬Ù‡ÙŠØ²Ø§Øª + Ù…Ø­Ø§Ø¶Ø± ØªØ´ØºÙŠÙ„'},
    {code:'4-1-1-1',level:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚',perf:73.25,indicator:'ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ù…Ø¨Ù†Ù‰ Ù„Ù„Ø¹Ø¯Ø¯ ÙˆØ§Ù„Ù…Ø±Ø­Ù„Ø©',improve:'ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø¨Ù†Ù‰ ÙˆØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø£Ø«Ø§Ø«.',evidence:'Ù…Ø±Ø§Ø³Ù„Ø§Øª + Ù…Ø®Ø·Ø·Ø§Øª + ØµÙˆØ±'},
    {code:'4-2-1-1',level:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚',perf:64.00,indicator:'Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ù…Ù† ÙˆØ§Ù„Ø³Ù„Ø§Ù…Ø©',improve:'ØªØ¹Ø²ÙŠØ² Ø«Ù‚Ø§ÙØ© Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ§Ù„ØªÙˆØ¹ÙŠØ©.',evidence:'ÙƒØ´ÙˆÙ ÙØ­Øµ + ÙØ±Ø¶ÙŠØ§Øª Ø¥Ø®Ù„Ø§Ø¡'},
    {code:'4-1-1-3',level:'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚',perf:62.50,indicator:'Ø§Ù„Ù…Ø±Ø§ÙÙ‚ ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø³Ø§Ù†Ø¯Ø©',improve:'ØªÙˆÙÙŠØ± Ù…Ø±Ø§ÙÙ‚ Ù…Ù„Ø§Ø¦Ù…Ø© ÙˆÙ…Ø³ØªØ¯Ø§Ù…Ø©.',evidence:'Ø§Ø³ØªØ¨Ø§Ù†Ø§Øª Ø±Ø¶Ø§ + ØªÙ‚Ø§Ø±ÙŠØ± Ø¬Ø§Ù‡Ø²ÙŠØ©'}
  ]
};

const drivingSubjects = [
  {key:'math',  name:'Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª', icon:'â—', tips:[
    'Ø®Ø·Ø© Ù…ÙƒØ«ÙØ© Ù„Ù…Ø³Ø§Ø¦Ù„ Ù„ÙØ¸ÙŠØ© ÙˆÙƒÙ…ÙŠÙ‘Ø© (3 Ø­ØµØµ Ø¹Ù„Ø§Ø¬ÙŠ/Ø£Ø³Ø¨ÙˆØ¹).',
    'Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù‚ØµÙŠØ±Ø© Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© + Ø¨Ù†Ùƒ Ø£Ø³Ø¦Ù„Ø© Ù‚Ø¯Ø±Ø§Øª.',
    'Ù…Ù†ØµÙ‘Ø© Ù…Ø­Ø§ÙƒØ§Ø© ÙŠÙˆÙ…ÙŠØ© 20 Ø¯Ù‚ÙŠÙ‚Ø©.'
  ]},
  {key:'physics',name:'Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡', icon:'âš›ï¸', tips:[
    'Ù…ÙØ§Ù‡ÙŠÙ… Ø£Ø³Ø§Ø³ÙŠØ© + ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø­ÙŠØ§ØªÙŠØ© Ù„ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø§Ø³ØªØ¯Ù„Ø§Ù„.',
    'Ù…Ø®ØªØ¨Ø± Ø£Ø³Ø¨ÙˆØ¹ÙŠ ÙˆØªØ¬Ø§Ø±Ø¨ Ø³Ø±ÙŠØ¹Ø©.',
    'Ø®Ø±Ø§Ø¦Ø· Ù…ÙØ§Ù‡ÙŠÙ… Ù„Ù„Ø£Ø³Ø¦Ù„Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ø®Ø·ÙˆØ§Øª.'
  ]},
  {key:'chem',  name:'Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡', icon:'ğŸ§ª', tips:[
    'Ø¬Ø¯Ø§ÙˆÙ„ ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª + ØªØ¯Ø±ÙŠØ¨ Ù…ÙˆØ§Ø²Ù†Ø©.',
    'Ù…Ø³Ø§Ø¦Ù„ Ù‚ÙŠØ§Ø³ÙŠØ© ÙƒØ±ÙˆØªÙŠÙ†.',
    'Ù…Ø´Ø§Ø±ÙŠØ¹ Ø¯Ù‚ÙŠÙ‚Ø© 5 Ø¯Ù‚Ø§Ø¦Ù‚ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø­ØµØ©.'
  ]},
  {key:'bio',   name:'Ø§Ù„Ø£Ø­ÙŠØ§Ø¡',  icon:'ğŸ§¬', tips:[
    'Ù…Ù„Ø®ØµØ§Øª Ù…Ø±Ø¦ÙŠØ© Ù„Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø­ÙŠÙˆÙŠØ©.',
    'Ø¨Ø·Ø§Ù‚Ø§Øª Ù…ÙØ§Ù‡ÙŠÙ… + Ø£Ø³Ø¦Ù„Ø© ÙÙ‡Ù… Ø¹Ù…ÙŠÙ‚.',
    'ØªØ¹Ù„Ù… Ø°Ø§ØªÙŠ Ù…ÙˆØ¬Ù‘Ù‡ 15 Ø¯Ù‚ÙŠÙ‚Ø©.'
  ]},
  {key:'arabic',name:'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', icon:'ğŸ“š', tips:[
    'Ù‚Ø±Ø§Ø¡Ø© Ø³Ø±ÙŠØ¹Ø© + Ù…ÙØ±Ø¯Ø§Øª + ØªØ­Ù„ÙŠÙ„ Ù†Øµ.',
    'ØªÙ…Ø§Ø±ÙŠÙ† ØªØ±Ø§ÙƒÙŠØ¨/Ø¥Ù…Ù„Ø§Ø¡ ØªÙƒØ±Ø§Ø±ÙŠØ©.',
    'Ù†Ù…Ø§Ø°Ø¬ Ù‚Ø¯Ø±Ø§Øª Ù„ÙØ¸ÙŠ Ù…Ø±ØªÙŠÙ† Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ‹Ø§.'
  ]}
];
</script>

<script>
function renderDashboard(){
  const dash=document.getElementById('dashboard'); dash.innerHTML='';
  Object.entries(fields).forEach(([key,f])=>{
    const lvl=perfLevel(f.v2025);
    const card=document.createElement('div'); card.className='card'; card.id=`card-${key}`;
    card.innerHTML=`
      <h2>${f.name}</h2>
      <div class="kpi"><span>2024: ${fmt(f.v2024)}% â†’ 2025: ${fmt(f.v2025)}%</span></div>
      <div class="progress"><div class="bar" style="width:${Math.max(2,f.v2025)}%;background:${lvl.color}"></div></div>
      <div class="donutWrap">
        <canvas id="donut-${key}" class="donutCanvas" aria-label="ØªÙØ§ØµÙŠÙ„ ${f.name}"></canvas>
        <div class="donutCenter"><div class="lvl" style="color:${lvl.color}">${lvl.name}</div><div class="pct">${fmt(f.v2025)}%</div></div>
      </div>`;
    dash.appendChild(card);

    const ctx=document.getElementById(`donut-${key}`).getContext('2d');
    new Chart(ctx,{type:'doughnut',
      data:{labels:f.subs.map(s=>s.name),datasets:[{data:f.subs.map(s=>s.v),backgroundColor:f.subs.map(s=>perfLevel(s.v).color),borderWidth:0}]},
      options:{plugins:{legend:{display:false}},cutout:'68%',responsive:true,maintainAspectRatio:false,animation:{animateRotate:true,animateScale:true}}
    });

    card.addEventListener('click',()=>openFieldFullScreen(key));
  });
}

/* Ring helper */
function makeRing(container, valuePercent){
  const v=Math.max(0,Math.min(100,Number(valuePercent)||0));
  const ring=document.createElement('div'); ring.className='ring';
  ring.innerHTML=`
    <svg viewBox="0 0 100 100">
      <defs><linearGradient id="royalGrad" x1="0" x2="1" y1="0" y2="1"><stop offset="0%" stop-color="#16a34a"/><stop offset="50%" stop-color="#22c55e"/><stop offset="100%" stop-color="#2563eb"/></linearGradient></defs>
      <circle class="bg" cx="50" cy="50" r="48"></circle>
      <circle class="fg" cx="50" cy="50" r="48"></circle>
    </svg>
    <div class="ringGlow"></div><div class="ringValue">${v.toFixed(1)}%</div>`;
  container.appendChild(ring);
  requestAnimationFrame(()=>{
    const fg=ring.querySelector('.fg'); const C=2*Math.PI*48;
    fg.style.stroke='url(#royalGrad)'; fg.style.strokeDasharray=C;
    fg.style.transition='stroke-dashoffset 1200ms cubic-bezier(.22,.9,.29,1)';
    fg.style.strokeDashoffset=C*(1 - v/100);
  });
}
function classify(v){ if(v>=90) return 'Ù…Ù…ØªØ§Ø²'; if(v>=75) return 'Ù…ØªÙ‚Ø¯Ù‘Ù…'; if(v>=60) return 'Ù…Ø³ØªÙ‡Ø¯Ù'; return 'ÙŠØ­ØªØ§Ø¬ ØªØ¹Ø²ÙŠØ²'; }

function buildMetricCard(title, value, openHandler){
  const card=document.createElement('div'); card.className='metricCard small';
  card.innerHTML=`
    <div class="metricHead"><h3 class="metricTitle">${title}</h3></div>
    <div class="metricBody"><div class="ringWrap" id="ringHere" role="button" aria-label="Ø¹Ø±Ø¶ ${title}"></div></div>
    <div style="text-align:center;font-weight:800;color:#06353b;margin-top:6px">${value.toFixed(2)}% â€¢ ${classify(value)}</div>`;
  makeRing(card.querySelector('#ringHere'), value);
  card.querySelector('#ringHere').addEventListener('click', openHandler);
  return card;
}

/* Leadership (middle, wider) */
function buildMiddleLeadership(tahsili, qiyas){
  const card=document.createElement('div'); card.className='metricCard lead';
  card.innerHTML=`
    <div class="metricHead"><h3 class="metricTitle">Ù„ÙˆØ­Ø© Ù‚ÙŠØ§Ø¯Ø© Ø±ÙØ¹ Ø§Ù„Ù‚Ø¯Ø±Ø§Øª ÙˆØ§Ù„ØªØ­ØµÙŠÙ„ÙŠ</h3></div>
    <div class="metricBody"><div class="ringWrap" id="ringHere"></div></div>
    <div style="font-size:12px;color:#6f8e94;text-align:center;margin-top:6px">Ø£ÙÙƒØ§Ø± ÙØ§Ø¹Ù„Ø©</div>
    <ul style="margin:6px 18px;line-height:1.7">
      <li>ğŸ—‚ï¸ Ø®Ø·Ø© Ø¹Ù„Ø§Ø¬ÙŠØ© Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© + Ø¥Ø«Ø±Ø§Ø¦ÙŠØ© ÙˆÙÙ‚ Ø§Ù„ØªØ´Ø®ÙŠØµ.</li>
      <li>ğŸ•’ Ù…Ø­Ø§ÙƒØ§Ø© ÙŠÙˆÙ…ÙŠØ© (15â€“20 Ø¯Ù‚ÙŠÙ‚Ø©) + ğŸ§  Ø¨Ù†Ùƒ Ø£Ø³Ø¦Ù„Ø© Ù…ØªØ¯Ø±Ù‘Ø¬.</li>
      <li>ğŸ¤ PLC Ù…Ø±ÙƒÙ‘Ø²Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© ÙˆØ±ÙØ¹ Ø§Ù„Ø¥ØªÙ‚Ø§Ù†.</li>
    </ul>
    <div style="font-size:12px;color:#6f8e94;text-align:center">Ù…ÙˆØ§Ø¯ Ø§Ù„Ø±Ø§ÙØ¹Ø©</div>
    <div class="kbd-icons" id="kbdIcons"></div>`;
  const avg=(tahsili+qiyas)/2; makeRing(card.querySelector('#ringHere'), avg);

  const iconsWrap=card.querySelector('#kbdIcons');
  drivingSubjects.forEach(sub=>{
    const btn=document.createElement('button');
    btn.className='kbd-icon'; btn.innerHTML=`<span>${sub.icon}</span><span>${sub.name}</span>`;
    btn.addEventListener('click',()=>openSubjectPopup(sub));
    iconsWrap.appendChild(btn);
  });
  return card;
}

/* Subject popup */
function openSubjectPopup(sub){
  const sheet=document.createElement('div');
  sheet.style.cssText='position:fixed;inset:0;z-index:10001;background:rgba(0,0,0,.45);display:flex;align-items:center;justify-content:center';
  sheet.innerHTML=`
    <div style="width:min(720px,94vw);background:#fff;border:1px solid #e6efef;border-radius:16px;overflow:hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-bottom:1px solid #eef1f2">
        <strong style="color:#0b7e88">${sub.icon} Ø®Ø·Ø· Ø±ÙØ¹ â€” ${sub.name}</strong>
        <button class="close" style="border:0;background:#e8eff0;color:#034;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer">Ø¥ØºÙ„Ø§Ù‚ âœ•</button>
      </div>
      <div style="padding:12px">
        <ol style="margin:0 0 10px 18px; line-height:1.9">
          ${sub.tips.map(t=>`<li>${t}</li>`).join('')}
        </ol>
        <div style="display:flex; gap:8px; flex-wrap:wrap;justify-content:center">
          <span class="kbd-icon">ğŸ—‚ï¸ Ø®Ø·Ø© Ø¹Ù„Ø§Ø¬ÙŠØ©</span>
          <span class="kbd-icon">ğŸ§  Ø¨Ù†Ùƒ Ø£Ø³Ø¦Ù„Ø©</span>
          <span class="kbd-icon">ğŸ•’ Ù…Ø­Ø§ÙƒØ§Ø© ÙŠÙˆÙ…ÙŠØ©</span>
          <span class="kbd-icon">ğŸ“ Ù…Ù„Ø®ØµØ§Øª</span>
        </div>
      </div>
    </div>`;
  sheet.addEventListener('click',(ev)=>{const box=sheet.children[0]; if(!box.contains(ev.target)) document.body.removeChild(sheet);});
  sheet.querySelector('.close').addEventListener('click',()=>document.body.removeChild(sheet));
  document.body.appendChild(sheet);
}

/* Metrics render */
function renderMetricsSection(){
  const wrap=document.getElementById('metricsSection'); wrap.innerHTML='';
  const TAH=66.546, QIY=71.254;
  wrap.appendChild( buildMetricCard('Ø§Ù„ØªØ­ØµÙŠÙ„ÙŠ', TAH, ()=>metricModal.open('Ø§Ù„ØªØ­ØµÙŠÙ„ÙŠ','tahsili_image.png')) );
  wrap.appendChild( buildMiddleLeadership(TAH, QIY) );
  wrap.appendChild( buildMetricCard('Ø§Ù„Ù‚Ø¯Ø±Ø§Øª', QIY, ()=>metricModal.open('Ø§Ù„Ù‚Ø¯Ø±Ø§Øª','qiyas_image.png')) );
}
</script>

<script>
/* Evidence store (fallback) */
let eviStore = {}; // { rowId: [ {id?, text, term, week, date, link, fileName} ] }

/* ===== Password mini-modal controller ===== */
const PASSWORD_REQUIRED = '1447';
const pwdModal = {
  el: null, input: null, ok: null, cancel: null, closeBtn: null,
  _resolver: null,
  open(){
    this.input.value='';
    this.el.style.display='flex';
    this.el.setAttribute('aria-hidden','false');
    this.input.focus();
    return new Promise((resolve)=>{ this._resolver=resolve; });
  },
  close(){
    this.el.style.display='none';
    this.el.setAttribute('aria-hidden','true');
    this._resolver && this._resolver(false);
    this._resolver=null;
  },
  confirm(){
    const ok = (this.input.value.trim() === PASSWORD_REQUIRED);
    if(!ok){ alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©'); return; }
    this.el.style.display='none';
    this.el.setAttribute('aria-hidden','true');
    this._resolver && this._resolver(true);
    this._resolver=null;
  },
};

/* Supabase helpers */
async function supaFetchRow(rowId){
  if(!supa) return (eviStore[rowId]||[]);
  const { data, error } = await supa.from('evidence').select('*').eq('row_id', rowId).order('created_at',{ascending:true});
  if(error){ console.warn(error); return (eviStore[rowId]||[]); }
  return data.map(d=>({ id:d.id, text:d.text, term:d.term, week:d.week, date:d.date, link:d.link, fileName:d.file_name }));
}

/* Ø±ÙØ¹ Ù…Ù„Ù (Ø¥Ù† ÙˆÙØ¬Ø¯) Ø¥Ù„Ù‰ ØªØ®Ø²ÙŠÙ† Supabase ÙˆØ¥Ø±Ø¬Ø§Ø¹ Ø±Ø§Ø¨Ø· Ø¹Ø§Ù… */
async function uploadEvidenceFile(rowId, file){
  try{
    if(!file) return null;
    const path = `${rowId}/${Date.now()}_${file.name}`;
    const up = await supa.storage.from('evidence').upload(path, file, { upsert: false });
    if(up.error){ console.warn(up.error); alert('ØªØ¹Ø°Ø± Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù: '+up.error.message); return null; }
    const pub = supa.storage.from('evidence').getPublicUrl(path);
    return pub?.data?.publicUrl || null;
  }catch(e){ console.warn(e); return null; }
}

async function supaInsert(rowId,item){
  if(!supa){ if(!eviStore[rowId]) eviStore[rowId]=[]; eviStore[rowId].push(item); return true; }
  const { error } = await supa.from('evidence').insert({
    row_id:rowId, text:item.text, term:item.term, week:item.week,
    date:item.date, link:item.link, file_name:item.fileName
  });
  if(error){ alert('ØªØ¹Ø°Ù‘Ø± Ø­ÙØ¸ Ø§Ù„Ø´Ø§Ù‡Ø¯ ÙÙŠ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©: '+error.message); return false; }
  return true;
}

async function supaDeleteLast(rowId){
  if(!supa){
    if((eviStore[rowId]||[]).length) eviStore[rowId].pop();
    return true;
  }
  const { data, error } = await supa.from('evidence')
    .select('id')
    .eq('row_id',rowId)
    .order('created_at',{ascending:false})
    .limit(1);
  if(error){ alert('ØªØ¹Ø°Ù‘Ø± Ø§Ù„Ø­Ø°Ù: '+error.message); return false; }
  if(!data.length) return true;
  const { error:delErr } = await supa.from('evidence').delete().eq('id', data[0].id);
  if(delErr){ alert('ØªØ¹Ø°Ù‘Ø± Ø§Ù„Ø­Ø°Ù: '+delErr.message); return false; }
  return true;
}

let currentFieldKey=null;
const eviModalEl = { modal:null, text:null, term:null, week:null, hijri:null, file:null, link:null, owner:null, save:null, cancel:null, rowId:null };

function eviIconsHTML(){
  return `
    <div class="eviActions">
      <span class="eviIcon add" title="Ø¥Ø¶Ø§ÙØ© Ø´Ø§Ù‡Ø¯" aria-label="Ø¥Ø¶Ø§ÙØ© Ø´Ø§Ù‡Ø¯">ï¼‹</span>
      <span class="eviIcon delete" title="Ø­Ø°Ù Ø¢Ø®Ø± Ø´Ø§Ù‡Ø¯" aria-label="Ø­Ø°Ù Ø¢Ø®Ø± Ø´Ø§Ù‡Ø¯">ğŸ—‘ï¸</span>
    </div>`;
}

/* ÙØªØ­ Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù…Ø¬Ø§Ù„ */
async function openFieldFullScreen(key){
  currentFieldKey=key;
  const panel=document.getElementById('fullPanel');
  const title=document.getElementById('fpTitle');
  const body=document.getElementById('fpBody');
  const f=fields[key]; title.textContent='Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ â€“ '+f.name;

  const subsHtml=f.subs.map(s=>{
    const lb=perfLevel(s.v);
    return `<div class="subCard" style="border-color:${lb.color}30">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
        <strong>${s.name}</strong>
        <span class="chip" style="font-size:12px;color:${lb.color}">${fmt(s.v)}% â€¢ ${lb.name}</span>
      </div>
    </div>`;
  }).join('');

  const rows=(detailed[key]||[]).map((r,idx)=>{
    const rowId = `${key}-${idx}`;
    const lb=perfLevel(r.perf);
    return `<tr class="${levelRowClass(r.level)}" data-row="${rowId}">
      <td class="col-lvl">
        <div style="display:flex;align-items:center;gap:10px">
          <div class="miniGauge" data-p="${r.perf}" data-color="${lb.color}"></div>
          <div style="line-height:1.1">
            <span style="font-weight:800;color:${lb.color}">${r.level}</span><br/>
            <span style="font-size:12px;color:#6f8e94">${fmt(r.perf)}% â€¢ ${r.code}</span>
          </div>
        </div>
      </td>
      <td class="col-crit"><strong>${r.indicator}</strong></td>
      <td class="col-imp">${r.improve}</td>
      <td class="col-evi">
        <div class="eviBar" id="eviBar-${rowId}">â€”</div>
        ${eviIconsHTML()}
      </td>
    </tr>`;
  }).join('');

  body.innerHTML=`<div class="subgrid">${subsHtml}</div>
  <div class="tableWrap"><table>
    <thead><tr>
      <th class="col-lvl">Ø§Ù„Ù…Ø³ØªÙˆÙ‰/Ø§Ù„Ø£Ø¯Ø§Ø¡</th>
      <th class="col-crit">Ø§Ù„Ù…Ø¹ÙŠØ§Ø±/Ø§Ù„Ù…Ø¤Ø´Ø±</th>
      <th class="col-imp">Ù…Ù‚ØªØ±Ø­Ø§Øª Ø§Ù„ØªØ­Ø³ÙŠÙ†</th>
      <th class="col-evi">Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯</th>
    </tr></thead>
    <tbody>${rows}</tbody></table></div>`;

  // mini gauges
  document.querySelectorAll('.miniGauge').forEach(el=>{
    const p=parseFloat(el.dataset.p)||0, color=el.dataset.color||'#0b7e88';
    const r=14, c=2*Math.PI*r;
    el.innerHTML=`
      <svg viewBox="0 0 40 40">
        <circle cx="20" cy="20" r="${r}" stroke="#e6efef" stroke-width="6" fill="none"></circle>
        <circle class="fg" cx="20" cy="20" r="${r}" stroke="${color}" stroke-width="6" fill="none" stroke-linecap="round" style="transform:rotate(-90deg);transform-origin:50% 50%;stroke-dasharray:${c};stroke-dashoffset:${c}"></circle>
        <text x="20" y="20" style="font-size:9px;fill:#345;font-weight:700;dominant-baseline:middle;text-anchor:middle">${Math.round(p)}</text>
      </svg>`;
    requestAnimationFrame(()=>{el.querySelector('.fg').style.transition='.9s ease';el.querySelector('.fg').style.strokeDashoffset=c*(1 - (p/100));});
  });

  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø«Ù… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
  await Promise.all((detailed[key]||[]).map(async (_r,idx)=>{
    const rowId=`${key}-${idx}`;
    const items = await supaFetchRow(rowId);
    eviStore[rowId]=items||[];
    refreshRowEvidence(rowId);
  }));

  // Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª + Ø­Ù…Ø§ÙŠØ© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
  body.querySelectorAll('tr[data-row]').forEach(tr=>{
    const rowId=tr.getAttribute('data-row');

    // Ø¥Ø¶Ø§ÙØ© Ø´Ø§Ù‡Ø¯ (Ù…Ø¹ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±)
    tr.querySelector('.eviIcon.add').addEventListener('click', async ()=>{
      const ok=await pwdModal.open();
      if(!ok) return;
      openEvidenceModal(rowId);
    });

    // Ø­Ø°Ù Ø¢Ø®Ø± Ø´Ø§Ù‡Ø¯ (Ù…Ø¹ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±)
    tr.querySelector('.eviIcon.delete').addEventListener('click', async ()=>{
      const ok=await pwdModal.open();
      if(!ok) return;
      const done = await supaDeleteLast(rowId);
      if(done){
        if(eviStore[rowId]?.length) eviStore[rowId].pop();
        refreshRowEvidence(rowId);
      }
    });
  });

  // Ø£Ø²Ø±Ø§Ø± Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙˆØ­Ø©
  document.getElementById('btnFieldReport').onclick=()=>openDocWindow('ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¬Ø§Ù„',buildFieldReportHTML(key));
  document.getElementById('btnFieldPlan').onclick=()=>openDocWindow('Ø®Ø·Ø© ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø¬Ø§Ù„',buildFieldPlanHTML(key));
  document.getElementById('fpClose').onclick=(e)=>{e.preventDefault(); panel.style.display='none';};
  document.getElementById('fpHome').onclick=(e)=>{e.preventDefault(); panel.style.display='none';window.scrollTo({top:0,behavior:'smooth'})};

  panel.style.display='flex';
}

/* Ø¬Ø¹Ù„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø±ÙˆØ§Ø¨Ø· (ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ±) */
function refreshRowEvidence(rowId){
  const bar = document.getElementById(`eviBar-${rowId}`);
  if(!bar) return;
  const items = eviStore[rowId] || [];
  bar.innerHTML = items.length
    ? items.map((ev, i) => {
        const title = (ev.text || '').replace(/"/g, '&quot;');
        const num = i + 1;
        if(ev.link && /^https?:\/\//i.test(ev.link)){
          return `<a class="eviDot" href="${ev.link}" target="_blank" rel="noopener" title="${title}">${num}</a>`;
        }
        return `<span class="eviDot" title="${title}">${num}</span>`;
      }).join('')
    : 'â€”';
}

/* Evidence modal */
function openEvidenceModal(rowId){
  eviModalEl.rowId=rowId;
  eviModalEl.modal.style.display='flex'; eviModalEl.modal.setAttribute('aria-hidden','false');
  eviModalEl.owner.value = 'Ù…Ø¬Ø§Ù„: ' + (currentFieldKey||'');
}
function closeEvidenceModal(){
  eviModalEl.modal.style.display='none';
  eviModalEl.modal.setAttribute('aria-hidden','true');
  eviModalEl.rowId=null;
}
async function saveEvidence(){
  const id=eviModalEl.rowId; if(!id) return;
  const file = eviModalEl.file.files[0] || null;
  let filePublicUrl = null;
  if(file){ filePublicUrl = await uploadEvidenceFile(id, file); }

  const manualLink = eviModalEl.link.value.trim();
  const finalLink = manualLink || filePublicUrl || '';

  const item={
    text:eviModalEl.text.value.trim(),
    term:eviModalEl.term.value,
    week:eviModalEl.week.value,
    date:eviModalEl.hijri.value.trim(),
    link:finalLink,
    fileName:file?.name || ''
  };

  const ok = await supaInsert(id,item);
  if(ok){
    if(!eviStore[id]) eviStore[id]=[];
    eviStore[id].push(item);
    refreshRowEvidence(id);
  }

  closeEvidenceModal();
  eviModalEl.text.value=''; eviModalEl.hijri.value=''; eviModalEl.link.value=''; eviModalEl.file.value='';
}
</script>

<script>
/* Header (WHITE) for print pages */
function buildPrintHeaderHTML(titleText){
  return `
    <div style="width:100%;padding:10px 0 6px;display:flex;justify-content:center;align-items:center;background:#fff;border-bottom:1px solid #e7eff0">
      <div style="height:90px;width:95%;background:url('lolo.png') center/contain no-repeat"></div>
    </div>
    <h2 style="text-align:center;color:#0b7e88;margin:10px 0 10px;font-size:24px">${titleText}</h2>
  `;
}

/* ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¬Ø§Ù„ */
function buildFieldReportHTML(key){
  const f=fields[key];
  const rows=(detailed[key]||[]).map(r=>`
    <tr class="${levelRowClass(r.level)}">
      <td style="width:160px">${r.level}<br/>${fmt(r.perf)}%<br/><small>${r.code}</small></td>
      <td style="width:42%">${r.indicator}</td>
      <td style="width:auto">${r.improve}</td>
    </tr>`).join('');
  return `${buildPrintHeaderHTML('ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¬Ø§Ù„: '+f.name)}
  <table><thead><tr><th style="width:160px">Ø§Ù„Ù…Ø³ØªÙˆÙ‰/Ø§Ù„Ù†Ø³Ø¨Ø©/Ø§Ù„Ø±Ù…Ø²</th><th style="width:42%">Ø§Ù„Ù…Ø¹ÙŠØ§Ø±/Ø§Ù„Ù…Ø¤Ø´Ø±</th><th>Ù…Ù‚ØªØ±Ø­Ø§Øª Ø§Ù„ØªØ­Ø³ÙŠÙ†</th></tr></thead><tbody>${rows}</tbody></table>`;
}

/* Ø®Ø·Ø© Ø§Ù„Ù…Ø¬Ø§Ù„ */
function buildFieldPlanHTML(key){
  const f=fields[key];
  const rows=(detailed[key]||[]).map((r,i)=>{
    const duration = i%2? 'Ù¦ Ø£Ø³Ø§Ø¨ÙŠØ¹':'ÙØµÙ„ Ø¯Ø±Ø§Ø³ÙŠ';
    return `<tr>
      <td style="width:120px"><strong>${r.code}</strong></td>
      <td style="width:auto">${r.indicator}</td>
      <td style="width:auto">${r.improve}</td>
      <td style="width:120px">${duration}</td>
    </tr>`;
  }).join('');
  return `${buildPrintHeaderHTML('Ø®Ø·Ø© ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø¬Ø§Ù„: '+f.name)}
  <table><thead><tr><th style="width:120px">Ø±Ù…Ø² Ø§Ù„Ù…Ø¤Ø´Ø±</th><th>Ø§Ù„Ù‡Ø¯Ù/Ø§Ù„Ù…Ø¤Ø´Ø±</th><th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠ</th><th style="width:120px">Ø§Ù„Ù…Ø¯Ø©</th></tr></thead><tbody>${rows}</tbody></table>`;
}

/* Print window */
function openDocWindow(title,contentHTML){
  const w=window.open('','_blank'); if(!w){alert('ÙØ¶Ù„Ø§Ù‹ Ø§Ø³Ù…Ø­ Ø¨Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©.');return;}
  const doc=`<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="utf-8"/><title>${title}</title>
  <style>
    *{box-sizing:border-box} html,body{margin:0;font-family:'Tajawal',sans-serif;color:#06353b;background:#fff}
    @page{size:A4;margin:8mm} html,body{-webkit-print-color-adjust:exact; print-color-adjust:exact}
    .wrap{width:205mm;max-width:100%;margin:0 auto;padding:10px}
    table{width:100%;border-collapse:collapse;table-layout:fixed}
    thead th{background:#0f6f79;color:#fff;padding:10px}
    td,th{padding:10px;border:1px solid #e7eff0;text-align:center;vertical-align:middle}
    .row-excellent{background:#e9fff4}.row-verygood{background:#eef5ff}.row-good{background:#fff6ec}.row-medium{background:#ffefef}
    .toolbar{position:sticky;bottom:0;display:flex;justify-content:center;margin:10px 0}
    .print{padding:8px 12px;border:1px solid #0b7e88;border-radius:10px;background:#0b7e88;color:#fff;cursor:pointer}
    @media print{ .toolbar{display:none} }
  </style></head><body>
    <div class="wrap">${contentHTML}
      <div class="toolbar"><button class="print" onclick="window.print()">Ø·Ø¨Ø§Ø¹Ø©</button></div>
    </div></body></html>`;
  w.document.open(); w.document.write(doc); w.document.close();
}

/* Metric image modal controller */
const metricModal = { el:null, img:null, title:null, open:(title,src)=>{
  metricModal.el.style.display='flex'; metricModal.img.src = src; metricModal.title.textContent = title; metricModal.el.setAttribute('aria-hidden','false');
}, close:()=>{ metricModal.el.style.display='none'; metricModal.el.setAttribute('aria-hidden','true'); }};

/* INIT */
window.addEventListener('DOMContentLoaded',()=>{
  // Top links
  document.getElementById('btnExt2025').onclick=(e)=>{e.preventDefault();window.open(SRC_2025,'_blank','noopener');};
  document.getElementById('btnExt2024').onclick=(e)=>{e.preventDefault();window.open(SRC_2024,'_blank','noopener');};
  document.getElementById('btnFullPlan').onclick=(e)=>{e.preventDefault();window.open(PLAN_LINK,'_blank','noopener');};
  document.getElementById('btnOps').onclick   =(e)=>{e.preventDefault();window.open(OPS_LINK,'_blank','noopener');};
  document.getElementById('btnAnalyze').onclick=(e)=>{e.preventDefault(); renderDashboard(); window.scrollTo({top:document.getElementById('dashboard').offsetTop-10,behavior:'smooth'});};

  // Metric modal
  metricModal.el = document.getElementById('metricModal');
  metricModal.img = document.getElementById('metricModalImg');
  metricModal.title = document.getElementById('metricModalTitle');
  document.getElementById('metricModalClose').onclick=()=>metricModal.close();
  metricModal.el.addEventListener('click',(ev)=>{const sheet=metricModal.el.querySelector('.sheet'); if(!sheet.contains(ev.target)) metricModal.close();});

  // Evidence modal refs
  const m=document.getElementById('eviModal');
  eviModalEl.modal=m;
  eviModalEl.text=document.getElementById('eviText');
  eviModalEl.term=document.getElementById('eviTerm');
  eviModalEl.week=document.getElementById('eviWeek');
  eviModalEl.hijri=document.getElementById('eviHijri');
  eviModalEl.file=document.getElementById('eviFile');
  eviModalEl.link=document.getElementById('eviLink');
  eviModalEl.owner=document.getElementById('eviOwner');
  eviModalEl.save=document.getElementById('eviSave');
  eviModalEl.cancel=document.getElementById('eviCancel');

  // Weeks 1..19
  eviModalEl.week.innerHTML='';
  for(let i=1;i<=19;i++){
    const op=document.createElement('option');
    op.value='W'+i; op.textContent='Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ '+i; eviModalEl.week.appendChild(op);
  }
  document.getElementById('eviClose').onclick=closeEvidenceModal;
  eviModalEl.cancel.onclick=closeEvidenceModal;
  eviModalEl.save.onclick=saveEvidence;

  // Password modal refs
  pwdModal.el = document.getElementById('pwdModal');
  pwdModal.input = document.getElementById('pwdInput');
  pwdModal.ok = document.getElementById('pwdOk');
  pwdModal.cancel = document.getElementById('pwdCancel');
  pwdModal.closeBtn = document.getElementById('pwdClose');
  pwdModal.ok.addEventListener('click',()=>pwdModal.confirm());
  pwdModal.cancel.addEventListener('click',()=>pwdModal.close());
  pwdModal.closeBtn.addEventListener('click',()=>pwdModal.close());
  pwdModal.el.addEventListener('click',(ev)=>{
    const sheet=pwdModal.el.querySelector('.sheet');
    if(!sheet.contains(ev.target)) pwdModal.close();
  });

  // Ø±Ø³Ù… Ø£ÙˆÙ„ÙŠ
  renderDashboard();
  renderMetricsSection();
});
</script>
</body>
</html>
