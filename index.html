<!-- PART 1/8: HEAD & STYLES -->
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ููุตุฉ ุงูุชุญููู ูุงูุชุญุณูู ุงููุฏุฑุณู โ ุซุงูููุฉ ุงููุนููุจู</title>

<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&display=swap" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>

<style>
:root{
  --moe:#0b7e88; --ink:#06353b; --bg:#f5f8f8; --card:#ffffff;
  --muted:#6f8e94; --ok:#e9fff4; --vg:#eef5ff; --gd:#fff6ec; --md:#ffefef;
  --lv-excel:#16a34a; --lv-progress:#2563eb; --lv-launch:#f59e0b; --lv-ready:#e11d48;
  --hero-h: 220px;  --hero-w: 1400px;
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--ink);font-family:'Tajawal',sans-serif}
a{color:#135;text-decoration:none} a:hover{text-decoration:underline}

/* Hero */
.hero{width:100vw;margin:0;background:var(--bg);height:var(--hero-h);
  display:flex;align-items:center;justify-content:center}
.hero .brand{width:min(var(--hero-w),96vw);height:100%;
  background:url('logo.png') center/contain no-repeat}

/* Page */
.page{max-width:1280px;margin:0 auto;padding:0 16px}

/* Top buttons */
.controls{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;padding:10px 0 14px}
.btn{background:var(--moe);color:#fff;border:0;border-radius:12px;padding:10px 16px;font-weight:700;cursor:pointer;transition:.12s}
.btn:hover{filter:brightness(.97);transform:translateY(-1px)}
.btn.eval{background:linear-gradient(135deg,#0b7e88,#22b8a0)}
.btn.plan{background:linear-gradient(135deg,#2d6cdf,#4cc3ff)}
.btn.ops{background:linear-gradient(135deg,#f59e0b,#ffd166)}
.btn.light{background:#eef6f7;color:#06353b}

/* Fields grid */
.grid{display:grid;grid-template-columns:repeat(4,minmax(240px,1fr));gap:16px}
@media (max-width:1150px){.grid{grid-template-columns:repeat(3,minmax(220px,1fr))}}
@media (max-width:900px){.grid{grid-template-columns:repeat(2,minmax(220px,1fr))}}
@media (max-width:520px){.grid{grid-template-columns:1fr}}

/* Card */
.card{background:linear-gradient(180deg,#ffffff 0%,#f9feff 100%);border-radius:16px;padding:14px;border:1px solid #e6efef}
.card h2{margin:0 0 6px;color:var(--moe);font-size:20px}
.kpi{display:flex;justify-content:space-between;align-items:center;color:var(--muted);font-size:13px;gap:8px;flex-wrap:wrap}
.progress{height:10px;background:#e6efef;border-radius:999px;overflow:hidden;margin:8px 0}
.bar{height:100%}

/* Donut (glow) */
.donutWrap{position:relative;height:180px;display:flex;align-items:center;justify-content:center}
.donutCanvas{position:relative;width:100%;height:100%;filter:drop-shadow(0 4px 12px rgba(37,99,235,.15))}
.donutCenter{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;pointer-events:none}
.donutCenter .lvl{font-size:16px;font-weight:800}
.donutCenter .pct{font-size:12px;color:#6f8e94}
.donutWrap::after{content:"";position:absolute;inset:8px;border-radius:999px;box-shadow:0 0 0 0 rgba(37,99,235,.18);animation:pulseD 2.8s ease-in-out infinite}
@keyframes pulseD{0%{box-shadow:0 0 0 0 rgba(37,99,235,.18)}70%{box-shadow:0 0 0 18px rgba(37,99,235,0)}100%{box-shadow:0 0 0 0 rgba(37,99,235,0)}}

/* Full panel */
.fullpanel{position:fixed;inset:0;z-index:9998;background:rgba(6,53,59,.06);display:none;align-items:flex-start;justify-content:center;padding:12px 8px 24px}
.fullpanel .inner{width:min(1280px,96vw);max-height:90vh;overflow:auto;background:#fff;border-radius:16px;border:1px solid #e6efef;padding:14px}
.fullpanel .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;gap:8px;flex-wrap:wrap}
.pills{display:flex;gap:6px;flex-wrap:wrap}
.pill{display:inline-flex;align-items:center;gap:8px;border:0;cursor:pointer;padding:10px 14px;border-radius:999px;font-weight:800}
.pill.report{background:linear-gradient(135deg,#0b7e88,#1398a2);color:#fff}
.pill.plan{background:linear-gradient(135deg,#2563eb,#4cc3ff);color:#fff}
.fullpanel .close{background:#e8eff0;color:#034;border:0;border-radius:10px;padding:8px 12px;cursor:pointer;font-weight:700}

/* Sub cards + table */
.subgrid{display:grid;grid-template-columns:repeat(2,minmax(200px,1fr));gap:10px;margin-bottom:10px}
@media (max-width:680px){.subgrid{grid-template-columns:1fr}}
.subCard{background:radial-gradient(60% 60% at 50% 40%, #ffffff 0%, #f6fcfd 100%);border:1px solid #e6efef;border-radius:14px;padding:10px}
.tableWrap{margin-top:8px;overflow:auto}
table{width:100%;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;table-layout:fixed}
thead th{background:#0f6f79;color:#fff;padding:10px;font-weight:700}
tbody td{padding:10px;border-bottom:1px solid #eef3f3;vertical-align:top;word-break:break-word}
tbody tr:last-child td{border-bottom:0}
.row-excellent{background:var(--ok)} .row-verygood{background:var(--vg)} .row-good{background:var(--gd)} .row-medium{background:var(--md)}

/* Report/Plan columns */
th.col-lvl, td.col-lvl{width:160px}
th.col-crit{width:35%} th.col-imp{width:45%} th.col-evi{width:auto}

/* Evidence */
.eviBtns{display:flex;gap:6px;justify-content:center;flex-wrap:wrap;margin-top:6px}
.btn-evi{display:inline-flex;align-items:center;gap:6px;border:1px dashed #cfe4e6;background:#fff;color:#0b7e88;border-radius:999px;padding:6px 10px;font-weight:800;cursor:pointer;font-size:12px}
.btn-evi.danger{color:#e11d48;border-color:#f4c2ca}
.eviBar{display:flex;gap:6px;justify-content:center;flex-wrap:wrap;margin-top:8px}
.eviDot{width:26px;height:26px;border-radius:999px;border:1px dashed #cfe4e6;background:#fff;display:inline-flex;align-items:center;justify-content:center;font-weight:800;font-size:12px;color:#0b7e88}

/* Metrics row (middle wider) */
.metricsRow{display:grid;grid-template-columns:1fr 1.3fr 1fr;gap:16px;margin:14px 0 6px}
@media (max-width:960px){.metricsRow{grid-template-columns:1fr}}
.metricCard{position:relative;background:linear-gradient(180deg,#ffffff 0%,#f9feff 100%);border-radius:16px;padding:14px;border:1px solid #e6efef}
.metricHead{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:6px}
.metricTitle{margin:0;color:#0b7e88;font-size:18px;font-weight:800}

/* Rings + line */
.ringWrap{display:flex;align-items:center;gap:12px}
.ring{width:110px;height:110px;position:relative} .ring svg{width:110px;height:110px;display:block}
.ring .bg{stroke:#e6efef;stroke-width:10;fill:none}
.ring .fg{stroke:url(#royalGrad);stroke-width:10;fill:none;stroke-linecap:round;transform:rotate(-90deg);transform-origin:50% 50%}
.ringGlow{position:absolute;inset:-6px;border-radius:999px;box-shadow:0 0 0 0 rgba(37,99,235,.25);animation:pulse 2.2s ease-in-out infinite}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(37,99,235,.24)}70%{box-shadow:0 0 0 16px rgba(37,99,235,0)}100%{box-shadow:0 0 0 0 rgba(37,99,235,0)}}
.ringValue{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:900;font-size:18px;color:#06353b}
.lineWrap{flex:1}
.lineBar{height:14px;border-radius:999px;background:#e6efef;overflow:hidden;position:relative}
.lineFill{height:100%;width:0%;background:linear-gradient(90deg,#16a34a 0%, #22c55e 25%, #2563eb 75%, #3b82f6 100%);border-radius:999px;transition:width 1.2s cubic-bezier(.22,.9,.29,1)}

.metricCard.small .ring{width:96px;height:96px} .metricCard.small .ring svg{width:96px;height:96px}

/* Leadership icons */
.kbd-icons{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
.kbd-icon{display:flex;align-items:center;gap:8px;border:1px dashed #cfe4e6;background:#fff;padding:8px 10px;border-radius:12px;cursor:pointer;font-weight:800}
.kbd-icon:hover{background:#f4fbfb}
.kbd-icon svg{width:18px;height:18px}

/* Metric image modal */
.metricModal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;z-index:9999;padding:12px}
.metricModal .sheet{max-width:96vw;max-height:92vh;background:#fff;border-radius:16px;overflow:auto;border:1px solid #e6efef}
.metricModal img{display:block;max-width:100%;height:auto}
.metricModal .bar{display:flex;justify-content:space-between;gap:8px;align-items:center;padding:8px 12px;border-bottom:1px solid #eef1f2}
.metricModal .close{border:0;background:#e8eff0;color:#034;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer}

/* Evidence modal */
.modal{position:fixed;inset:0;display:none;z-index:10000;align-items:center;justify-content:center;background:rgba(6,53,59,.18);padding:12px}
.modal .sheet{width:min(920px,96vw);background:#fff;border-radius:16px;box-shadow:0 20px 40px rgba(0,0,0,.25);padding:14px;border:1px solid #e6efef;max-height:90vh;overflow:auto}
.modal .row{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:8px}
.modal label{display:block;font-size:12px;color:#355;margin-bottom:4px}
.modal input,.modal select{width:100%;padding:10px;border-radius:10px;border:1px solid #dfecec;background:#fff}
.modal .close{background:#e8eff0;color:#034;border:0;border-radius:10px;padding:8px 12px;cursor:pointer;font-weight:700}
@media (max-width:780px){ .modal .row{grid-template-columns:1fr} }

/* Footer & print */
.footer{padding:18px 10px;text-align:center;color:#7a9aa0}
@page{size:A4;margin:10mm}
@media print{
  .controls,.no-print,.fullpanel,.modal,.metricModal{display:none!important}
  .page{max-width:100%;margin:0 auto!important;padding:0 10mm}
  .hero{box-shadow:none!important;border-radius:0!important}
}
</style>
</head>
<!-- PART 2/8: BODY STRUCTURE -->
<body>
  <!-- Hero -->
  <div class="hero" aria-label="ูุฒุงุฑุฉ ุงูุชุนููู โ ุดุนุงุฑ">
    <div class="brand"></div>
  </div>

  <div class="page">
    <div class="controls">
      <button class="btn eval" id="btnExt2025" type="button">ุงูุชูููู ุงูุฎุงุฑุฌู ูขููขูฅู ๐</button>
      <button class="btn eval" id="btnExt2024" type="button">ุงูุชูููู ุงูุฎุงุฑุฌู ูขููขูคู ๐</button>
      <button class="btn" id="btnAnalyze" type="button">ุชุญููู ุดุงูู ๐</button>
      <button class="btn plan" id="btnFullPlan" type="button">ุฎุทุฉ ุงูุชุญุณูู ๐๏ธ</button>
      <button class="btn ops" id="btnOps" type="button">ุงูุฎุทุฉ ุงูุชุดุบูููุฉ ๐๏ธ</button>
    </div>

    <div id="dashboard" class="grid"></div>
    <section id="metricsSection" class="metricsRow"></section>

    <div class="footer">ุชูููุฐ ูุชุตููู ููุฏ ุญุงูุฏ ุงูุฒูุฑุงูู</div>
  </div>

  <!-- Full analysis panel -->
  <div class="fullpanel" id="fullPanel" aria-hidden="true">
    <div class="inner">
      <div class="topbar">
        <div class="title" id="fpTitle">ุงูุชุญููู ุงูุชูุตููู</div>
        <div class="pills">
          <button class="pill report" id="btnFieldReport" type="button" title="ุชูุฑูุฑ ุงููุฌุงู ููุทุจุงุนุฉ">ุชูุฑูุฑ ุงููุฌุงู</button>
          <button class="pill plan" id="btnFieldPlan" type="button" title="ุฎุทุฉ ุชุญุณูู ุงููุฌุงู ููุทุจุงุนุฉ">ุฎุทุฉ ุงููุฌุงู</button>
          <button class="close" id="fpHome" type="button">ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ โต</button>
          <button class="close" id="fpClose" type="button">ุฅุบูุงู โ</button>
        </div>
      </div>
      <div id="fpBody"></div>
    </div>
  </div>

  <!-- Metric image modal -->
  <div class="metricModal" id="metricModal" aria-hidden="true">
    <div class="sheet">
      <div class="bar">
        <strong id="metricModalTitle" style="color:#0b7e88">ุนุฑุถ</strong>
        <button class="close" id="metricModalClose" type="button">ุฅุบูุงู โ</button>
      </div>
      <img id="metricModalImg" alt="ุนุฑุถ"/>
    </div>
  </div>

  <!-- Evidence modal -->
  <div class="modal" id="eviModal" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true" aria-labelledby="eviTitle">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:6px">
        <h4 id="eviTitle" style="margin:0;text-align:center;color:#0b7e88">ุฅุถุงูุฉ ุดุงูุฏ</h4>
        <button class="close" id="eviClose" type="button">โ ุฅุบูุงู</button>
      </div>

      <div class="row" style="margin-bottom:8px">
        <div><label>ุงุณู/ูุตู ุงูุดุงูุฏ</label><input id="eviText" type="text" placeholder="ูุซุงู: ุชุญููู ูุชุงุฆุฌ ุตู1.."/></div>
        <div><label>ุงููุตู ุงูุฏุฑุงุณู</label><select id="eviTerm"><option value="T1">ุงูุฃูู</option><option value="T2">ุงูุซุงูู</option></select></div>
        <div><label>ุงูุฃุณุจูุน</label><select id="eviWeek"></select></div>
        <div><label>ุงูุชุงุฑูุฎ (ูุฌุฑู)</label><input id="eviHijri" type="text" placeholder="1447/03/01"/></div>
      </div>

      <div class="row">
        <div><label>ุฑูุน ููู (PDF/ุตูุฑุฉ)</label><input id="eviFile" type="file" accept="application/pdf,image/*"/></div>
        <div><label>ุฑุงุจุท ุงูุดุงูุฏ (ุงุฎุชูุงุฑู)</label><input id="eviLink" type="url" placeholder="https://..."/></div>
        <div style="grid-column:span 2"><label>ูุชุจุน</label><input id="eviOwner" type="text" disabled/></div>
      </div>

      <div style="display:flex;gap:8px;margin-top:8px;justify-content:center">
        <button class="btn" id="eviSave" type="button">ุญูุธ ุงูุดุงูุฏ</button>
        <button class="btn light" id="eviCancel" type="button">ุฅูุบุงุก</button>
      </div>
      <div class="small" style="margin-top:6px;text-align:center">* ุงูุดูุงูุฏ ุชูุนุฑุถ ูุจุงุดุฑุฉ ุจุนุฏ ุงูุญูุธ ููููู ุญุฐููุง ูู ุงูุฌุฏูู.</div>
    </div>
  </div>
<!-- PART 3/8: LINKS & HELPERS -->
<script>
/* Links */
const SRC_2025='https://drive.google.com/file/d/1s0Rrv8gYkAbbZU3YudxWVC943iU18Df0/view?usp=drive_link';
const SRC_2024='https://drive.google.com/file/d/1YsfKzyjQl1SHuz24LLepZK8lb_ylf1Ar/view?usp=drive_link';
const PLAN_LINK='https://drive.google.com/file/d/1O9o7rYNrtVW8gnOQLGd-lSQCiKq4eHne/view?usp=sharing';
const OPS_LINK='https://drive.google.com/file/d/1ItrZpaptSVaR_qFqMLhzHRAduIeJESa2/view?usp=sharing';

/* Helpers */
const fmt=v=>Number(v).toFixed(2);
function perfLevel(pct){
  if(pct>=90) return {name:'ุงูุชูููุฒ', key:'excel',  color:getComputedStyle(document.documentElement).getPropertyValue('--lv-excel').trim()};
  if(pct>=75) return {name:'ุงูุชูุฏูู', key:'progress',color:getComputedStyle(document.documentElement).getPropertyValue('--lv-progress').trim()};
  if(pct>=50) return {name:'ุงูุงูุทูุงู', key:'launch', color:getComputedStyle(document.documentElement).getPropertyValue('--lv-launch').trim()};
  return {name:'ุงูุชููุฆุฉ', key:'ready', color:getComputedStyle(document.documentElement).getPropertyValue('--lv-ready').trim()};
}
function levelRowClass(arLevel){
  if(arLevel==='ุงูุชูููุฒ'||arLevel==='ุงูุชูุฏูู') return 'row-excellent';
  if(arLevel==='ุงูุงูุทูุงู') return 'row-verygood';
  if(arLevel==='ุงูุชููุฆุฉ') return 'row-good';
  return 'row-medium';
}
</script>
<!-- PART 4/8: FIELDS & DETAILED DATA -->
<script>
const fields={
  management:{name:'ุงูุฅุฏุงุฑุฉ ุงููุฏุฑุณูุฉ',v2024:75.50,v2025:75.50,subs:[
    {id:'planning',name:'ุงูุชุฎุทูุท',v:54.00},{id:'lead',name:'ููุงุฏุฉ ุงูุนูููุฉ ุงูุชุนููููุฉ',v:72.75},
    {id:'soc',name:'ุงููุฌุชูุน ุงููุฏุฑุณู',v:57.25},{id:'dev',name:'ุงูุชุทููุฑ ุงููุคุณุณู',v:60.25}
  ]},
  teaching:{name:'ุงูุชุนููู ูุงูุชุนููู',v2024:80.75,v2025:81.50,subs:[
    {id:'assess',name:'ุชูููู ุงูุชุนููู',v:82.75},{id:'exp',name:'ุจูุงุก ุฎุจุฑุงุช ุงูุชุนููู',v:76.75}
  ]},
  learning:{name:'ููุงุชุฌ ุงูุชุนููู',v2024:78.50,v2025:78.50,subs:[
    {id:'ach',name:'ุงูุชุญุตูู ุงูุชุนูููู',v:80.25},{id:'socdev',name:'ุงูุชุทูุฑ ุงูุดุฎุตู ูุงูุตุญู ูุงูุงุฌุชูุงุนู',v:86.25}
  ]},
  environment:{name:'ุงูุจูุฆุฉ ุงููุฏุฑุณูุฉ',v2024:64.00,v2025:62.25,subs:[
    {id:'safety',name:'ุงูุฃูู ูุงูุณูุงูุฉ',v:79.00},{id:'building',name:'ุงููุจูู ุงููุฏุฑุณู',v:71.50}
  ]}
};

const detailed={
  management:[
    {code:'1-1-1-1',level:'ุงูุชูุฏูู',perf:81.75,indicator:'ุชุถุน ุงููุฏุฑุณุฉ ุฎุทุฉ ุชุดุบูููุฉ ููุชููุฉ ุงูุนูุงุตุฑ ููู ุฃูุฏุงู ุชุทููุฑูุฉ ูุญุฏุฏุฉ',improve:'ุชุทููุฑ ุฎุทุฉ ุชุดุบูููุฉ ูุฑูุฉ ุจุฃูุฏุงู ุทููุญุฉ ูุจุฑุงูุฌ ููุจุงุฏุฑุงุช ููุคุดุฑุงุช ุฃุฏุงุก ูููุงู ููุณุคูููุงุช ููุฒูููุฉุ ูุฎุทุท ุงุณุชุฏุงูุฉ ูุชุญุณูู.',evidence:'ุฎุทุฉ ุชุดุบูููุฉ ูุนุชูุฏุฉ + ูุญุถุฑ ูุฌูุฉ ุงูุฎุทุฉ + ูุตูููุฉ KPI'},
    {code:'2-1-1-1',level:'ุงูุชููุฆุฉ',perf:42.00,indicator:'ุชุชุงุจุน ุงููุฏุฑุณุฉ ุชูููุฐ ุฎุทุชูุง ูุชุทูุฑูุง ุจูุง ูุถูู ุชุญููู ุฃูุฏุงููุง',improve:'ูุชุงุจุนุฉ ุงูุชูููุฐ ูุชููููู ุจุงูุชุธุงู ููู ูุคุดุฑุงุช ูุงุถุญุฉุ ูุชุทููุฑ ุงูุฎุทุฉ ูุถูุงู ุชุญููู ุงูุฃูุฏุงู.',evidence:'ุชูุงุฑูุฑ ูุชุงุจุนุฉ ุดูุฑูุฉ + ุงุฌุชูุงุนุงุช ูุชุงุจุนุฉ + ุฅุฌุฑุงุกุงุช ุชุตุญูุญ'},
    {code:'1-1-2-1',level:'ุงูุชูุฏูู',perf:76.25,indicator:'ุชุนุฒุฒ ุงููุฏุฑุณุฉ ุงูููู ุงูุฅุณูุงููุฉ ูุงููููุฉ ุงููุทููุฉ',improve:'ุบุฑุณ ุงูููู ูุงููููุฉ ูุชุนุฒูุฒ ุงูุงูุชูุงุก ุนุจุฑ ุฃูุดุทุฉ ูููุงุณุจุงุช ูุจุฑุงูุฌ ูุจุชูุฑุฉ ุฏุงุฎู ุงููุฏุฑุณุฉ ููุน ุงููุฌุชูุน.',evidence:'ุฎุทุฉ ููุงุณุจุงุช ูุทููุฉ + ุชูุซูู ุงูุชูููุฐ + ุงุณุชุจุงูุงุช ุฃุซุฑ'},
    {code:'1-2-1-2',level:'ุงูุชูุฏูู',perf:81.25,indicator:'ุชูุชุฒู ุงููุฏุฑุณุฉ ุจููู ูููุฉ ุงูุชุนููู ูุฃุฎูุงููุงุชูุง',improve:'ุชุนุฒูุฒ ุงูุงูุชุฒุงู ุจููุงุนุฏ ุงูุณููู ุงููุธููู ูุฃุฎูุงููุงุช ุงููููุฉ ูุงูุชูุนูุฉ ุจุฃุณุงููุจ ูุจุชูุฑุฉ ูุฏุนู ุงูุนูุงูุงุช ุงูุฅูุฌุงุจูุฉ.',evidence:'ุชุนููู ุงูููุซุงู + ุชูููุนุงุช ุงุทูุงุน + ุจุฑูุงูุฌ ุชูุนูู'},
    {code:'1-2-1-3',level:'ุงูุชูุฏูู',perf:83.00,indicator:'ุชููุฑ ุงููุฏุฑุณุฉ ููุงุฎูุง ุขูููุง ููุชุนูู ูุงูููู ููุณูููุง ูุงุฌุชูุงุนูููุง',improve:'ููุงุฎ ุขูู ููุญูุงุฑ ูุงูุชุนุงูู ูุงูุงุญุชุฑุงูุ ูุจุฑุงูุฌ ุนูุงุฌูุฉ/ููุงุฆูุฉ ูุชูููู ุงูุชููุฑ.',evidence:'ุจุฑูุงูุฌ ุฅุฑุดุงุฏ + ุณุฌู ุญุงูุงุช ููุนุงูุฌุฉ + ุญููุงุช ุชูุนูุฉ'},
    {code:'1-2-1-4',level:'ุงูุชูููุฒ',perf:94.75,indicator:'ุชูุดุฑ ุงููุฏุฑุณุฉ ููุงุนุฏ ุงูุณููู ูุงูููุงุธุจุฉุ ูุชุชุงุจุน ุชุทุจูููุง',improve:'ุงูุงุณุชูุฑุงุฑ ูู ูุดุฑ ุงูููุงุนุฏ ูุชุญุฏูุฏ ุงูุชููุนุงุช ููุชุงุจุนุฉ ุงูุชุทุจูู ุจุงูุชุธุงู ุจุฃุณุงููุจ ูุจุชูุฑุฉ.',evidence:'ูุงุฆุญุฉ ููุดูุฑุฉ + ุฏูุงุฆู ูุดุฑ + ุชูุงุฑูุฑ ุงูุถุจุงุท'},
    {code:'5-1-2-1',level:'ุงูุงูุทูุงู',perf:62.50,indicator:'ุชููุฑ ุงููุฏุฑุณุฉ ุจุฑุงูุฌ ูุฃูุดุทุฉ ุชุฑุจููุฉ ุฏุงุนูุฉ ููุณููู ุงูุฅูุฌุงุจู',improve:'ุฃูุดุทุฉ ุนูุงุฌูุฉ/ููุงุฆูุฉ ุดุงููุฉ ูุฑุชุจุทุฉ ุจุชุดุฎูุต ุงููุดููุงุชุ ูุชุงุจุนุฉ ูุชุทููุฑ ูุงุณุชุซูุงุฑ ุงูุดุฑุงูุงุช.',evidence:'ุฎุทุฉ ุชุนุฒูุฒ ุงูุณููู + ุฃุฏูุงุช ุชุดุฎูุต + ููุงุณ ุฃุซุฑ'},
    {code:'6-1-2-1',level:'ุงูุชููุฆุฉ',perf:45.00,indicator:'ุจุฑุงูุฌ ูุฃูุดุทุฉ ุฅุซุฑุงุฆูุฉ ุบูุฑ ุตููุฉ ูุชุทููุฑ ููุงูุจ ุงููุชุนูููู ูุชููุฆุชูู ูููุณุชูุจู',improve:'ุฃุณุงููุจ ูุดู ุงููููุจุฉ ูุชุญููุฒ ููุงููุณ ูููุจุฉ ูุฃูุดุทุฉ ุฅุซุฑุงุฆูุฉ ูุฑุชุจุทุฉ ุจุงูุงุญุชูุงุฌุงุช ูุญูุงูุฒ ููุดุงุฑูุงุช ุชูุงูุณูุฉ.',evidence:'ูุงุนุฏุฉ ุงูููููุจูู + ูุดุงุฑูุงุช ูููุจุฉ + ุฎุทุฉ ุฅุซุฑุงุฆูุฉ'},
    {code:'1-3-1-1',level:'ุงูุงูุทูุงู',perf:68.25,indicator:'ุชุนุฒุฒ ุงููุฏุฑุณุฉ ุจูุงุก ุงูุนูุงูุงุช ุงูุฅูุฌุงุจูุฉ ูุงูุชุนุงูู ูู ุงููุฌุชูุน ุงููุฏุฑุณู',improve:'ููุงู ุชุดุฌุน ุงูุนูู ุจุฑูุญ ุงููุฑูู ูุชุนุฒูุฒ ุงูุนูุงูุงุช ุงูุฅูุณุงููุฉ ููุชุงุจุนุฉ ูุงุณุชุฏุงูุฉ ูุชุทููุฑ.',evidence:'ูุญุงุถุฑ ูุฑู/PLC + ุชูุฒูุน ุฃุฏูุงุฑ + ุงุณุชุจุงูุฉ ุชูุงุณู'},
    {code:'2-1-3-1',level:'ุงูุงูุทูุงู',perf:55.25,indicator:'ุชุนุฒุฒ ุงููุฏุฑุณุฉ ูุดุงุฑูุฉ ุงูุฃุณุฑุฉ ูู ุชุนูู ุฃุจูุงุฆูู ูุงูุชุญุถูุฑ ููุณุชูุจููู',improve:'ูุฑุต ุชูุงุตู ูุนูุงูุฉ ูุน ุงูุฃุณุฑุฉ ูุจุฑุงูุฌ ุชูุนููุฉ ูุจุชูุฑุฉ ูุฅุดุฑุงููู ูู ุงูุชุญุถูุฑ ูููุณุชูุจู ูุชูููู ุงูุฎุฏูุงุช.',evidence:'ููุงุกุงุช ุฃูููุงุก ุงูุฃููุฑ + ูููุงุช ุชูุงุตู + ุชุบุฐูุฉ ุฑุงุฌุนุฉ'},
    {code:'3-1-3-1',level:'ุงูุชููุฆุฉ',perf:39.75,indicator:'ุชุนุฒุฒ ุงููุฏุฑุณุฉ ุงูุดุฑุงูุฉ ุงููุฌุชูุนูุฉ ูุฏุนู ุงูุชุนูู ูุงูุชุฃุซูุฑ ุงูุฅูุฌุงุจู',improve:'ุชูุงุตู ูุชููุน ูุน ุงููุฌุชูุนุ ุงุณุชุซูุงุฑ ุฅููุงูุงุช ุงููุคุณุณุงุช ุงููุทููุฉุ ูุนุงููุงุช ุชูุนููุฉ ูุฅุชุงุญุฉ ุงูุฅููุงูุงุช.',evidence:'ุฎุทุงุจุงุช/ุงุชูุงููุงุช ุดุฑุงูุฉ + ูุนุงููุงุช + ููุงุณ ุฃุซุฑ'},
    {code:'1-1-4-1',level:'ุงูุชููุฆุฉ',perf:24.75,indicator:'ุชุดุฌุน ุงููุฏุฑุณุฉ ููุณูุจููุง ููุญุตูู ุนูู ุงูุฑุฎุตุฉ ุงูููููุฉ',improve:'ุจุฑุงูุฌ ุชูุนููุฉ/ุชุญููุฒูุฉ ููุชุงุจุนุฉ ุงูุชูุฏู ููู ุงูุฑุชุจ ุงูููููุฉ.',evidence:'ุณุฌู ุงูุฑุฎุต + ุฎุทุฉ ุชุญููุฒูุฉ + ููุงุนูุฏ ุงุฎุชุจุงุฑุงุช'},
    {code:'1-4-1-2',level:'ุงูุงูุทูุงู',perf:53.00,indicator:'ุชุฏุนู ุงููุฏุฑุณุฉ ุงูุชุทููุฑ ุงููููู ููู ูุชุงุฆุฌ ุชูููู ุงูุฃุฏุงุก ูุงุญุชูุงุฌุงุชูู',improve:'ุฎุทุฉ ุชุทููุฑ ูููู ูุฑุชุจุทุฉ ุจุชูููู ุงูุฃุฏุงุกุ ูุชุงุจุนุฉ ุงูุชูููุฐ ูููุงุณ ุงูุฃุซุฑ ูุชุดุฌูุน PLC ูุงูุจุญูุซ ุงูุฅุฌุฑุงุฆูุฉ.',evidence:'ุฎุทุฉ ุชุฏุฑูุจ ุณูููุฉ + ุณุฌูุงุช ุญุถูุฑ + ููุงุณ ุฃุซุฑ'},
    {code:'3-1-4-1',level:'ุงูุชูุฏูู',perf:79.25,indicator:'ุชุทุจู ุงููุฏุฑุณุฉ ุงูุชูููู ุงูุฐุงุชูู ุงููุจููู ุนูู ูุนุงููุฑ ุงูููุฆุฉ',improve:'ุชูููุฐ ุงูุชูููู ุงูุฐุงุชู ููู ุงูุฅุทุงุฑุ ูุดุฑ ุงูุซูุงูุฉุ ุฅุดุฑุงู ุงููุฌุชูุน ุงููุฏุฑุณูุ ูุฎุทุฉ ุทููุญุฉ ูููู ุงููุนุฑูุฉ.',evidence:'ุฃุฏุงุฉ ูุชูุงุฑูุฑ ุชูููู ุฐุงุชู + ุฎุทุฉ ุชุญุณูู ูุดุชูุฉ'},
    {code:'1-4-1-4',level:'ุงูุงูุทูุงู',perf:74.00,indicator:'ุชููุฐ ุงููุฏุฑุณุฉ ุฎุทุฉ ููุชุญุณูู ุจูุงุกู ุนูู ูุชุงุฆุฌ ุงูุชูููู ูุชุชุงุจุนูุง',improve:'ุชุทููุฑ ุฎุทุฉ ุชุญุณูู ุจุฃููููุงุช ุชุนุงูุฌ ุฌูุงูุจ ูุคุซุฑุฉ ูู ููุงุชุฌ ุงูุชุนูู ููุชุงุจุนุฉ ุงูุชูููุฐ.',evidence:'ุฎุทุฉ ุชุญุณูู ูุนุชูุฏุฉ + ุชูุงุฑูุฑ ุชูุฏู + ููุงุกูุฉ ุชุดุบูููุฉ'}
  ],
  teaching:[
    {code:'2-1-1-2',level:'ุงูุชูููุฒ',perf:97.75,indicator:'ุชุฏุนู ุงููุฏุฑุณุฉ ุชูููุฐ ุงูููุงูุฌ ููู ุงูุฎุทุฉ ุงูุฏุฑุงุณูุฉ',improve:'ุงูุงุณุชูุฑุงุฑ ูู ุชูููุฑ ุฃูุดุทุฉ ููุตุงุฏุฑ ูุจุชูุฑุฉ ุชุฏุนู ุชุนูู ุงููุนุงุฑู/ุงูููุงุฑุงุช ูุงูููู ููุชุงุจุนุฉ ุงูุชูููุฐ ูุชุญููู ุงูุชููุนุงุช ุงูุนุงููุฉ.',evidence:'ุฎุทุท ุชูุฒูุน + ุณุฌูุงุช ุชุทุจูู + ุฏุฑูุณ ูููุฐุฌูุฉ'},
    {code:'2-2-1-3',level:'ุงูุชูููุฒ',perf:93.25,indicator:'ุชูุฏู ุงููุฏุฑุณุฉ ุงูุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ ูููุชุนูููู ุจุงูุชุธุงู',improve:'ุงูุงุณุชูุฑุงุฑ ูู ุงูุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ ุงูููุฑูุฉ ูุงูุจููุงุกุฉ ุจุทุฑู ูุชููุนุฉ ูุฏุนู ุงูุชุนูู ูุชุญุณูู ุงูุฃุฏุงุก.',evidence:'ููุงุฐุฌ ุชุบุฐูุฉ ุฑุงุฌุนุฉ + ูุชุงุจุนุฉ ูุฑุฏูุฉ'},
    {code:'8-1-1-2',level:'ุงูุชูุฏูู',perf:88.50,indicator:'ุชููู ุงููุฏุฑุณุฉ ุงูููุงุฑุงุช ุงูุนุงุทููุฉ ูุงูุงุฌุชูุงุนูุฉ ูุฏู ุงููุชุนูููู',improve:'ุจูุฆุฉ ุชุนูู ุชุนุฒุฒ ุงูุชุญูู ุจุงูุนูุงุทู ูุงูุซูุฉ ุจุงูููุณ ูุงูุชุนุงูู ูุงูุชูุงุตู ูุงูุญูุงุฑ ูุงูุงุญุชุฑุงู ุงููุชุจุงุฏู.',evidence:'ุจุฑุงูุฌ SEL + ุฌูุณุงุช ุฅุฑุดุงุฏ + ุงุณุชุจุงูุงุช ููุงุฑูุฉ'},
    {code:'2-1-2-2',level:'ุงูุชูุฏูู',perf:79.50,indicator:'ุชุญูู ูุชุงุฆุฌ ุงูุชูููู ูุชูุธููุง ูู ุชุญุณูู ููุงุชุฌ ุงูุชุนูู',improve:'ุชุญููู ุงููุชุงุฆุฌ ูุชูุณูุฑูุง ูุงุชุฎุงุฐ ูุฑุงุฑุงุช ูุจูุงุก ุฎุทุท ุนูุงุฌูุฉ/ุฅุซุฑุงุฆูุฉ ูุชุญููู ุงูุชููุนุงุช ุงููุณุชูุฏูุฉ.',evidence:'ุชูุงุฑูุฑ ุชุญููู + ุฎุทุท ุนูุงุฌ/ุฅุซุฑุงุก + ูุชุงุจุนุฉ ุชูุฏู'},
    {code:'3-1-1-2',level:'ุงูุชูุฏูู',perf:79.25,indicator:'ุชููุน ุงููุฏุฑุณุฉ ูู ุฅุณุชุฑุงุชูุฌูุงุช ุงูุชุฏุฑูุณ',improve:'ุฎุจุฑุงุช ุชุนูู ุซุฑูุฉ ุชุดุฌุน ุงูุจุญุซ/ุงูุชุฌุฑูุจ ูุชุฑุงุนู ุงููุฑูู ูุชูุจู ุงูุงุญุชูุงุฌุงุช (ููููู ุฐูู ุงูุฅุนุงูุฉ ูุงูููููุจูู).',evidence:'ุฎุทุท ุฏุฑูุณ ูุชููุนุฉ + ุฒูุงุฑุงุช ุตููุฉ'},
    {code:'6-1-1-2',level:'ุงูุชูุฏูู',perf:77.50,indicator:'ุชููู ุงููุฏุฑุณุฉ ุงูููุงุฑุงุช ุงููุฑุงุฆูุฉ ูุงูุนุฏุฏูุฉ ุงูุฃุณุงุณูุฉ',improve:'ุชุนุฒูุฒ ุงููุฑุงุกุฉ/ุงููุชุงุจุฉ ูุงูููุงุฑุงุช ุงูุนุฏุฏูุฉ ุนุจุฑ ุฃูุดุทุฉ ุตููุฉ ููุงุตููุฉ ูุฎุทุฉ ูุฑูุฒุฉ ุทูููุฉ ุงููุฏู.',evidence:'ุงุฎุชุจุงุฑุงุช ุชุดุฎูุตูุฉ + ุฎุทุฉ ุนูุงุฌ + ุชุชุจุน ูุฑุฏู'},
    {code:'2-2-1-1',level:'ุงูุชูุฏูู',perf:77.25,indicator:'ุชูููู ุงููุฏุฑุณุฉ ุฃุฏุงุก ุงููุชุนูููู ุจุฃุณุงููุจ ูุฃุฏูุงุช ูุชููุนุฉ ููุงุนูุฉ',improve:'ุฃุณุงููุจ ุชุดุฎูุตูุฉ/ุชูููููุฉ/ุฎุชุงููุฉุ ุชูุงุซู ููุงุฑุงุช ุงููุนูููู ูู ุงูุชููููุ ูุดุงุฑูุฉ ุงููุชุนูููู ูู ุชูููู ุฃุฏุงุฆูู.',evidence:'ุจูู ุฃุณุฆูุฉ + ุฃุฏูุงุช ุชูููู + ูููุงุช ุฅูุฌุงุฒ'},
    {code:'2-1-1-10',level:'ุงูุชูุฏูู',perf:77.25,indicator:'ุชุนุฒุฒ ุงููุฏุฑุณุฉ ุฏุงูุนูุฉ ุงููุชุนูููู ููุชุนูู ูุงูุงุณุชูุชุงุน ุจู',improve:'ุจูุฆุฉ ุชุนูู ุชุญูู ุงูุฑูุงู ูุชุซูุฑ ุงููุถูู ูุชุทุจู ุฃุณุงููุจ ุชุญููุฒ ุชุฑุงุนู ุงููููู ูุงูุงูุชูุงูุงุช.',evidence:'ุจุฑุงูุฌ ุชุญููุฒูุฉ + ูุณุงุจูุงุช + ุจุทุงูุงุช ุชุดุฌูุน'},
    {code:'1-1-1-2',level:'ุงูุชูุฏูู',perf:76.75,indicator:'ุชููุฑ ุงููุฏุฑุณุฉ ูุฑุตูุง ูุชูุงูุฆุฉ ููุชุนูู (ุฐูู ุงูุฅุนุงูุฉ/ุงูููููุจูู)',improve:'ูุฑุต ุชุนูู ูุชูุงูุฆุฉ ูุงุณุชุฌุงุจุฉ ููุงุญุชูุงุฌุงุช ุงููุฎุชููุฉ ูุงููุตูู ุงูุดุงูู ููุชุงุจุนุฉ ุงูุงูุชุฒุงู.',evidence:'ุฎุทุท ูุฑุฏูุฉ IEP + ุชููููุงุช + ููุงุฆู ููููุจูู'},
    {code:'7-1-1-2',level:'ุงูุชูุฏูู',perf:75.25,indicator:'ุชููู ุงููุฏุฑุณุฉ ููุงุฑุงุช ุงูุชูููุฑ ุงูุนููุง ูุฏู ุงููุชุนูููู',improve:'ุฃุณุงููุจ ูุฃูุดุทุฉ ูุชููุฒุฉ ูุชูููุฉ ุงูุชุญููู ูุงูุงุณุชูุชุงุฌ ูุงูุชูููู ูุงูุฅุจุฏุงุน ูุญู ุงููุดููุงุช.',evidence:'ููุชุฌุงุช ุชุนูู + Rubrics ุชูููุฑ ุนููุง'},
    {code:'4-1-1-2',level:'ุงูุงูุทูุงู',perf:69.75,indicator:'ุชูุนูู ุงููุฏุฑุณุฉ ุงูุชุนูู ุงูุฅููุชุฑููู',improve:'ุชุฌููุฒุงุช ุชูููุฉ ูุฃูุดุทุฉ ุชุฏูุฌ ุงูุชุนูู ุงูุตูู ูุงูุฅููุชุฑููู ูููููุง ูููุทูุงุฑุฆ.',evidence:'ุชูุนูู ููุตุฉ + ุฏุฑูุณ ุฑูููุฉ + ุชูุงุฑูุฑ ุฏุฎูู'},
    {code:'5-1-1-2',level:'ุงูุงูุทูุงู',perf:62.00,indicator:'ุชููุฑ ุงููุฏุฑุณุฉ ุฃูุดุทุฉ ุชุนูู ุชุทุจูููุฉ ูุฑุชุจุทุฉ ุจุงูุญูุงุฉ',improve:'ุฑุจุท ุงูุฎุจุฑุงุช ุจุงููุงูุน ูุชุดุฌูุน ุงูุชุฌุงุฑุจ ุงูุนูููุฉ ูุงูุงุณุชูุตุงุก ูุชุทุจูู ุงููุนุฑูุฉ.',evidence:'ูุดุงุฑูุน/ููุงู ุฃุฏุงุฆูุฉ + ุณูุงูู ุชูุฏูุฑ'},
    {code:'9-1-1-2',level:'ุงูุงูุทูุงู',perf:60.75,indicator:'ุชููู ุงููุฏุฑุณุฉ ุงูููุงุฑุงุช ุงูุฑูููุฉ ูุฏู ุงููุชุนูููู',improve:'ุชุนุฒูุฒ ุงุณุชุฎุฏุงู ุงูุชูููุฉุ ุงูุชุนุงูู ูุน ุงูุจูุงูุงุชุ ูุฑุต ุชุนูู ุฑูููุฉ ุซุฑูุฉ ูุชูุธูู ุงูุจุฑูุฌูุงุช ูููุตูู ูููุนุฑูุฉ.',evidence:'ุชุฏุฑูุจุงุช ุชูููุฉ + ููุชุฌุงุช ุฑูููุฉ ุทูุงุจูุฉ'}
  ],
  learning:[
    {code:'3-2-1-1',level:'ุงูุชูููุฒ',perf:95.50,indicator:'ูุธูุฑ ุงููุชุนูููู ุงูุงุนุชุฒุงุฒ ุจุงูููู ูุงููููุฉ ุงููุทููุฉ',improve:'ุงูุงุณุชูุฑุงุฑ ูู ุชุนุฒูุฒ ุงูููู ูุงููููุฉ ูุงููุบุฉ ุงูุนุฑุจูุฉ ูุงุณุชุซูุงุฑ ุงูููุงุณุจุงุช ุงููุทููุฉ ุจุฃุณุงููุจ ูุจุชูุฑุฉ.',evidence:'ูุนุงููุงุช ูุทููุฉ ููุซูุฉ + ุฃุนูุงู ุทูุงุจูุฉ + ุงุณุชุจุงูุงุช ุงุชุฌุงูุงุช'},
    {code:'5-1-2-3',level:'ุงูุชูููุฒ',perf:94.00,indicator:'ููุชุฒู ุงููุชุนูููู ุจููุงุนุฏ ุงูุณููู ูุงูุงูุถุจุงุท ุงููุฏุฑุณู',improve:'ุงูุงุณุชูุฑุงุฑ ุจุจุฑุงูุฌ ูุชููุนุฉ ููุจุชูุฑุฉ ูุชุฌุณูุฏ ุงููุณุคูููุฉ ุงูุฐุงุชูุฉ.',evidence:'ุชูุงุฑูุฑ ุงูุถุจุงุท + ุจุฑุงูุฌ ุชุนุฒูุฒ + ูุชุงุจุนุฉ ุญุถูุฑ'},
    {code:'3-2-1-2',level:'ุงูุชูููุฒ',perf:91.75,indicator:'ูุธูุฑ ุงููุชุนูููู ุงุชุฌุงูุงุช ุฅูุฌุงุจูุฉ ูุญู ุฐูุงุชูู',improve:'ุงูุงุณุชูุฑุงุฑ ูู ุชุนุฒูุฒ ุงูุฑูุงู ูุงูุฑุถุง ูุงูุณุนุงุฏุฉ.',evidence:'ุจุฑุงูุฌ ุฑูุงู + ุงุณุชุจุงูุงุช ุณุนุงุฏุฉ + ุฌูุณุงุช ุฅุฑุดุงุฏ'},
    {code:'7-1-2-3',level:'ุงูุชูููุฒ',perf:91.75,indicator:'ูุธูุฑ ุงููุชุนูููู ุงุนุชุฒุงุฒูุง ุจุซูุงูุชูู ูุงุญุชุฑุงููุง ููุชููุน ุงูุซูุงูู',improve:'ุงูุงุณุชูุฑุงุฑ ูู ุชุนุฒูุฒ ุงูุซูุงุจุช ุงููุทููุฉ ูุงููุฎุฑ ุจุงูุนุฑุจูุฉ ูุงุญุชุฑุงู ุงูุชููุน ุงูุซูุงูู.',evidence:'ููุชุฌุงุช ุซูุงููุฉ/ูุบููุฉ + ูุนุงููุงุช + ุณูุงุณุงุช ุชูููุน'},
    {code:'6-1-2-3',level:'ุงูุชูุฏูู',perf:84.25,indicator:'ูุธูุฑ ุงููุชุนูููู ุงููุฏุฑุฉ ุนูู ุงูุจุญุซ ูุงูุชุนูู ุงูุฐุงุชู',improve:'ุชูููุฉ ููุงุฑุงุช ุงูุจุญุซ ูุงูุชุนูู ุงูุฐุงุชู ูููุงู ุฃุฏุงุฆูุฉ ุชุฑุชุจุท ุจุงูุญูุงุฉ ูุฅุฏุงุฑุฉ ุงูููุช ูุชูุธูู ุงูุชูููุฉ.',evidence:'ูููุงุช ูุดุงุฑูุน + Rubrics ุจุญูุซ + ุฏูุฑุงุช ููุงุฑุงุช ุจุญุซ'},
    {code:'2-1-1-3',level:'ุงูุชูุฏูู',perf:82.94,indicator:'ูุญูู ุงููุชุนูููู ูุชุงุฆุฌ ูุชูุฏูุฉ ูู ุงุฎุชุจุงุฑุงุช ุงููุฏุฑุงุช ุงูุนุงูุฉ',improve:'ุชุนุฒูุฒ ุงููุฏุฑุงุช ุงูุชุญููููุฉ ูุงูุงุณุชุฏูุงููุฉ ูุงูููุทููุฉ ูุงูููุงุณ ูุญู ุงููุดููุงุช.',evidence:'ูุชุงุฆุฌ ูุฏุฑุงุช + ุฎุทุฉ ุชุฏุฑูุจ (ููุธู/ููู) + ูุญุงูุงุฉ'},
    {code:'3-1-2-3',level:'ุงูุชูุฏูู',perf:82.50,indicator:'ููุชุฒู ุงููุชุนูููู ุจุงูููุงุฑุณุงุช ุงูุตุญูุฉ ุงูุณูููุฉ',improve:'ุชุนุฒูุฒ ุงูููุงุฑุณุงุช ุงูุตุญูุฉ ูุจุฑุงูุฌ ุงููุดุงุท ุงูุจุฏูู ูุงูุบุฐุงุก ุงูุตุญู ูุงููุธุงูุฉ.',evidence:'ุฎุทุฉ ุตุญุฉ ูุฏุฑุณูุฉ + ูุนุงููุงุช + ุณุฌูุงุช'},
    {code:'1-1-1-3',level:'ุงูุชูุฏูู',perf:79.04,indicator:'ูุญูู ุงููุชุนูููู ูุชุงุฆุฌ ูุชูุฏูุฉ ูู ุงูุงุฎุชุจุงุฑุงุช ุงูุชุญุตูููุฉ',improve:'ุจูุงุก ุฃุณุงุณ ููู ูู ุงููุนุงุฑู ูุงูููุงุฑุงุช ูุชุนุฒูุฒ ุงูุงุณุชุนุฏุงุฏ ุงูุฏุฑุงุณู.',evidence:'ูุชุงุฆุฌ ุชุญุตููู + ุฎุทุฉ ุฑูุน ุชุญุตูู + ูุฌููุนุงุช ุชูููุฉ'},
    {code:'4-1-2-3',level:'ุงูุงูุทูุงู',perf:63.25,indicator:'ูุดุงุฑู ุงููุชุนูููู ูู ุงูุฃูุดุทุฉ ุงููุฌุชูุนูุฉ ูุงูุฃุนูุงู ุงูุชุทูุนูุฉ',improve:'ุจุฑุงูุฌ ููุนูุฉ ุชุญูุฒ ุงููุดุงุฑูุฉ ูุงูุชุทุจูู ูุญููู ูุจุชูุฑุฉ ุชุนุฒุฒ ุงููุณุคูููุฉ.',evidence:'ููุตุฉ ุชุทูุน + ุดูุงุฏุงุช ุณุงุนุงุช + ุชูุงุฑูุฑ ูุจุงุฏุฑุงุช'}
  ],
  environment:[
    {code:'4-2-1-2',level:'ุงูุชูููุฒ',perf:97.00,indicator:'ุชุนูู ุงููุฏุฑุณุฉ ุนูู ุตูุงูุฉ ุฌููุน ูุฑุงูู ุงููุจูู ูุชุฌููุฒุงุชู ุจุงูุชุธุงู',improve:'ุงูุงุณุชูุฑุงุฑ ูู ูุชุงุจุนุฉ ุงูุตูุงูุฉ ูุถูุงู ููุงุกุฉ ุงููุจูู ููุงุนููุชู.',evidence:'ุฃูุงูุฑ ุนูู ุตูุงูุฉ + ุฌุฏูู ุตูุงูุฉ ููุงุฆูุฉ + ุชูุงุฑูุฑ ุฅูุฌุงุฒ'},
    {code:'4-2-1-3',level:'ุงูุชูุฏูู',perf:79.50,indicator:'ุชุนูู ุงููุฏุฑุณุฉ ุนูู ูุธุงูุฉ ุงููุจูู ุงููุฏุฑุณู ูุฌููุน ูุฑุงููู ุจุงูุชุธุงู',improve:'ุงูุนูู ุนูู ุงููุธุงูุฉ ูุงููุชุงุจุนุฉ ุจุงูุชุธุงู ูุชูููุฑ ุฃุฏูุงุช ุงููุธุงูุฉ.',evidence:'ุนูุฏ ูุธุงูุฉ + ุฌุฏุงูู ุฅุดุฑุงู + ุจุทุงูุงุช ูุชุงุจุนุฉ'},
    {code:'2-1-1-4',level:'ุงูุชูุฏูู',perf:79.00,indicator:'ุชุชูุงูุฑ ูุตูู ููุนุงูู ููุงุฆูุฉ ููุนูููุฉ ุงูุชุนููููุฉ ุชูุจู ุงุญุชูุงุฌุงุช ุงููุชุนูููู ุจูู ูููู ุฐูู ุงูุฅุนุงูุฉ',improve:'ุชูุธูู ุงููุตูู ูุงููุนุงูู ูุชุฌููุฒุงุชูุง ููู ุงููุนุงููุฑ ูุชูููุฑ ุงููุณุงุฆู ูุงูุฃุฏูุงุช ุงููุงุฒูุฉ.',evidence:'ุฌุฑุฏ ุชุฌููุฒุงุช + ูุญุงุถุฑ ุชุดุบูู ูุนุงูู + ุตูุงูุฉ ููุงุฆูุฉ'},
    {code:'4-1-1-1',level:'ุงูุงูุทูุงู',perf:73.25,indicator:'ุชูุธูู ูุจูู ุงููุฏุฑุณุฉ ููุงุฆู ูุนุฏุฏ ุงููุชุนูููู ูุงููุฑุญูุฉ ุงูุนูุฑูุฉ',improve:'ุงูุนูู ูุน ุงูุฌูุงุช ุฐุงุช ุงูุนูุงูุฉ ูุชุทููุฑ ุงููุจูู ูุชูุธูู ุงูุฃุซุงุซ ุจูุง ูุญูู ุงูุฑูุงู ูููุจู ุงููุชุทูุจุงุช.',evidence:'ูุฑุงุณูุงุช ุฑุณููุฉ + ูุฎุทุทุงุช ูุงุนุงุช + ุตูุฑ ูุจู/ุจุนุฏ'},
    {code:'4-2-1-1',level:'ุงูุงูุทูุงู',perf:64.00,indicator:'ุชุชูุงูุฑ ูู ูุตูู ุงููุฏุฑุณุฉ ููุนุงูููุง ูุฌููุน ูุฑุงูููุง ูุชุทูุจุงุช ุงูุฃูู ูุงูุณูุงูุฉ',improve:'ูุชุงุจุนุฉ ูุชุทูุจุงุช ูุชุฌููุฒุงุช ุงูุณูุงูุฉ ูุชุนุฒูุฒ ุซูุงูุชูุง ูุงูุชูุนูุฉ ุจุงููุฎุงุทุฑ ููุชุงุจุนุฉ ุงูุฏุฎูู ูุงูุฎุฑูุฌ.',evidence:'ูุดูู ูุญุต ุณูุงูุฉ + ูุฑุถูุงุช ุฅุฎูุงุก + ุฎุทุท ูุฎุงุทุฑ'},
    {code:'4-1-1-3',level:'ุงูุงูุทูุงู',perf:62.50,indicator:'ุชูุจู ุงููุฑุงูู ูุงูุฎุฏูุงุช ุงููุณุงูุฏุฉ ุงุญุชูุงุฌุงุช ุงููุชุนูููู ุจูู ูููู ุฐูู ุงูุฅุนุงูุฉ',improve:'ุชูููุฑ ูุฑุงูู ูุฎุฏูุงุช ูุณุงูุฏุฉ ููุงุฆูุฉ ูุชุญููู ุงูุฑูุงู ูุงููุญุงูุธุฉ ุนูู ุงุณุชุฏุงูุชูุง.',evidence:'ุชูุงุฑูุฑ ุฌุงูุฒูุฉ ูุฑุงูู + ุงุณุชุจุงูุงุช ุฑุถุง + ุทูุจุงุช ุชุญุณูู'}
  ]
};
</script>
<!-- PART 5/8: DRIVING SUBJECTS -->
<script>
const drivingSubjects = [
  {key:'math',  name:'ุงูุฑูุงุถูุงุช', icon:'โ', tips:[
    'ุฎุทุฉ ููุซูุฉ ููุณุงุฆู ููุธูุฉ ูููููุฉ (3 ุญุตุต ุนูุงุฌู/ุฃุณุจูุน).',
    'ุงุฎุชุจุงุฑุงุช ูุตูุฑุฉ ุฃุณุจูุนูุฉ + ุจูู ุฃุณุฆูุฉ ูุฏุฑุงุช.',
    'ููุตูุฉ ูุญุงูุงุฉ ููููุฉ 20 ุฏูููุฉ.'
  ]},
  {key:'physics',name:'ุงูููุฒูุงุก', icon:'โ๏ธ', tips:[
    'ููุงููู ุฃุณุงุณูุฉ + ุชุทุจููุงุช ุญูุงุชูุฉ ูุชุนุฒูุฒ ุงูุงุณุชุฏูุงู.',
    'ูุฎุชุจุฑ ุฃุณุจูุนู ูุชุฌุงุฑุจ ุณุฑูุนุฉ.',
    'ุฎุฑุงุฆุท ููุงููู ููุฃุณุฆูุฉ ูุชุนุฏุฏุฉ ุงูุฎุทูุงุช.'
  ]},
  {key:'chem',  name:'ุงูููููุงุก', icon:'๐งช', tips:[
    'ุฌุฏุงูู ุชูุงุนููุฉ ูููุนุงุฏูุงุช + ุชุฏุฑูุจ ููุงุฒูุฉ.',
    'ูุณุงุฆู ููุงุณูุฉ ูุฑูุชูู.',
    'ูุดุงุฑูุน ุฏูููุฉ 5 ุฏูุงุฆู ููุงูุฉ ุงูุญุตุฉ.'
  ]},
  {key:'bio',   name:'ุงูุฃุญูุงุก',  icon:'๐งฌ', tips:[
    'ููุฎุตุงุช ูุฑุฆูุฉ ูููุณุงุฑุงุช ุงูุญูููุฉ.',
    'ุจุทุงูุงุช ููุงููู + ุฃุณุฆูุฉ ููู ุนููู.',
    'ุชุนูู ุฐุงุชู ููุฌูู 15 ุฏูููุฉ.'
  ]},
  {key:'arabic',name:'ุงููุบุฉ ุงูุนุฑุจูุฉ', icon:'๐', tips:[
    'ูุฑุงุกุฉ ุณุฑูุนุฉ + ููุฑุฏุงุช + ุชุญููู ูุต.',
    'ุชูุงุฑูู ุชุฑุงููุจ/ุฅููุงุก ุชูุฑุงุฑูุฉ.',
    'ููุงุฐุฌ ูุฏุฑุงุช ููุธู ูุฑุชูู ุฃุณุจูุนููุง.'
  ]}
];
</script>
<!-- PART 6/8: RENDER DASHBOARD & METRICS -->
<script>
function renderDashboard(){
  const dash=document.getElementById('dashboard'); dash.innerHTML='';
  Object.entries(fields).forEach(([key,f])=>{
    const lvl=perfLevel(f.v2025);
    const card=document.createElement('div'); card.className='card'; card.id=`card-${key}`;
    card.innerHTML=`
      <h2>${f.name}</h2>
      <div class="kpi"><span>2024: ${fmt(f.v2024)}% โ 2025: ${fmt(f.v2025)}%</span></div>
      <div class="progress"><div class="bar" style="width:${Math.max(2,f.v2025)}%;background:${lvl.color}"></div></div>
      <div class="donutWrap">
        <canvas id="donut-${key}" class="donutCanvas"></canvas>
        <div class="donutCenter"><div class="lvl" style="color:${lvl.color}">${lvl.name}</div><div class="pct">${fmt(f.v2025)}%</div></div>
      </div>`;
    dash.appendChild(card);

    const ctx=document.getElementById(`donut-${key}`).getContext('2d');
    new Chart(ctx,{type:'doughnut',
      data:{labels:f.subs.map(s=>s.name),datasets:[{data:f.subs.map(s=>s.v),backgroundColor:f.subs.map(s=>perfLevel(s.v).color),borderWidth:0}]},
      options:{plugins:{legend:{display:false}},cutout:'68%',responsive:true,maintainAspectRatio:false,animation:{animateRotate:true,animateScale:true}}
    });

    // ุงูุชุญ ุงูุชุญููู ุงูุชูุตููู
    document.getElementById(`donut-${key}`).addEventListener('click',()=>openFieldFullScreen(key));
  });
}

/* Helpers for ring + line */
function makeRing(container, valuePercent){
  const v=Math.max(0,Math.min(100,Number(valuePercent)||0));
  const ring=document.createElement('div'); ring.className='ring';
  ring.innerHTML=`
    <svg viewBox="0 0 100 100">
      <defs><linearGradient id="royalGrad" x1="0" x2="1" y1="0" y2="1"><stop offset="0%" stop-color="#16a34a"/><stop offset="50%" stop-color="#22c55e"/><stop offset="100%" stop-color="#2563eb"/></linearGradient></defs>
      <circle class="bg" cx="50" cy="50" r="48"></circle>
      <circle class="fg" cx="50" cy="50" r="48"></circle>
    </svg>
    <div class="ringGlow"></div><div class="ringValue">${v.toFixed(1)}%</div>`;
  container.appendChild(ring);
  requestAnimationFrame(()=>{
    const fg=ring.querySelector('.fg'); const C=2*Math.PI*48;
    fg.style.stroke='url(#royalGrad)'; fg.style.strokeDasharray=C;
    fg.style.transition='stroke-dashoffset 1200ms cubic-bezier(.22,.9,.29,1)';
    fg.style.strokeDashoffset=C*(1 - v/100);
  });
}
function makeLine(container, valuePercent){
  const v=Math.max(0,Math.min(100,Number(valuePercent)||0));
  const wrap=document.createElement('div'); wrap.className='lineWrap';
  wrap.innerHTML=`<div class="lineBar"><div class="lineFill"></div></div>`;
  container.appendChild(wrap);
  requestAnimationFrame(()=>{wrap.querySelector('.lineFill').style.width=v+'%';});
}
function classify(v){ if(v>=90) return 'ููุชุงุฒ'; if(v>=75) return 'ูุชูุฏูู'; if(v>=60) return 'ูุณุชูุฏู'; return 'ูุญุชุงุฌ ุชุนุฒูุฒ'; }

function buildMetricCard(title, value, openHandler){
  const card=document.createElement('div'); card.className='metricCard small';
  card.innerHTML=`
    <div class="metricHead"><h3 class="metricTitle">${title}</h3></div>
    <div class="metricBody">
      <div class="ringWrap" id="ringHere"></div>
      <div style="flex:1">
        <div style="font-size:12px;color:#6f8e94">ุงููุณุจุฉ ุงูุญุงููุฉ</div>
        <div style="font-weight:800;color:#06353b;margin-bottom:6px">${value.toFixed(2)}% โข ${classify(value)}</div>
        <div id="lineHere"></div>
        <div style="margin-top:8px"><button class="btn light" type="button">ุนุฑุถ ุตูุฑุฉ ุงูุฏููู</button></div>
      </div>
    </div>`;
  makeRing(card.querySelector('#ringHere'), value);
  makeLine(card.querySelector('#lineHere'), value);
  card.querySelector('.btn.light').addEventListener('click', openHandler);
  return card;
}

/* Leadership center card */
function buildMiddleLeadership(tahsili, qiyas){
  const card=document.createElement('div'); card.className='metricCard';
  card.innerHTML=`
    <div class="metricHead"><h3 class="metricTitle">ููุญุฉ ููุงุฏุฉ ุฑูุน ุงููุฏุฑุงุช ูุงูุชุญุตููู</h3></div>
    <div class="metricBody">
      <div class="ringWrap" id="ringHere"></div>
      <div style="flex:1">
        <div style="font-size:12px;color:#6f8e94">ุฃููุงุฑ ูุงุนูุฉ:</div>
        <ul style="margin:6px 16px;line-height:1.6">
          <li>ุฎุทุฉ ุฃุณุจูุนูุฉ ุนูุงุฌูุฉ + ุฅุซุฑุงุฆูุฉ ููู ูุชุงุฆุฌ ุงูุชุดุฎูุต.</li>
          <li>ูุญุงูุงุฉ ููููุฉ (15โ20 ุฏูููุฉ) + ุจูู ุฃุณุฆูุฉ ูุชุฏุฑุฌ.</li>
          <li>ูุฌุชูุนุงุช ุชุนูู ููููุฉ (PLC) ูุฑููุฒุฉ ุนูู ุญู ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ.</li>
        </ul>
        <div style="font-size:12px;color:#6f8e94">ููุงุฏ ุงูุฑุงูุนุฉ:</div>
        <div class="kbd-icons" id="kbdIcons"></div>
      </div>
    </div>`;
  const avg=(tahsili+qiyas)/2; makeRing(card.querySelector('#ringHere'), avg);

  // Icons
  const iconsWrap=card.querySelector('#kbdIcons');
  drivingSubjects.forEach(sub=>{
    const btn=document.createElement('button');
    btn.className='kbd-icon'; btn.innerHTML=`<span>${sub.icon}</span><span>${sub.name}</span>`;
    btn.addEventListener('click',()=>openSubjectPopup(sub));
    iconsWrap.appendChild(btn);
  });
  return card;
}

/* Subject popup */
function openSubjectPopup(sub){
  const sheet=document.createElement('div');
  sheet.style.cssText='position:fixed;inset:0;z-index:10001;background:rgba(0,0,0,.45);display:flex;align-items:center;justify-content:center';
  sheet.innerHTML=`
    <div style="width:min(720px,94vw);background:#fff;border:1px solid #e6efef;border-radius:16px;overflow:hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-bottom:1px solid #eef1f2">
        <strong style="color:#0b7e88">${sub.icon} ุฎุทุท ุฑูุน โ ${sub.name}</strong>
        <button class="close" style="border:0;background:#e8eff0;color:#034;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer">ุฅุบูุงู โ</button>
      </div>
      <div style="padding:12px">
        <ol style="margin:0 0 10px 18px; line-height:1.9">
          ${sub.tips.map(t=>`<li>${t}</li>`).join('')}
        </ol>
        <div style="display:flex; gap:8px; flex-wrap:wrap">
          <span class="kbd-icon">๐๏ธ ุฎุทุฉ ุนูุงุฌูุฉ</span>
          <span class="kbd-icon">๐ง ุจูู ุฃุณุฆูุฉ</span>
          <span class="kbd-icon">๐ ูุญุงูุงุฉ ููููุฉ</span>
          <span class="kbd-icon">๐ ููุฎุตุงุช</span>
        </div>
      </div>
    </div>`;
  sheet.addEventListener('click',(ev)=>{const box=sheet.querySelector('div > div'); if(!box.contains(ev.target)) document.body.removeChild(sheet);});
  sheet.querySelector('.close').addEventListener('click',()=>document.body.removeChild(sheet));
  document.body.appendChild(sheet);
}

/* Metrics render */
function renderMetricsSection(){
  const wrap=document.getElementById('metricsSection'); wrap.innerHTML='';
  const TAH=66.546, QIY=71.254; // ุจุฏูู ุชูุงุฑูุฎ ููุง ุทูุจุช
  wrap.appendChild( buildMetricCard('ุงูุชุญุตููู', TAH, ()=>metricModal.open('ุงูุชุญุตููู','tahsili_image.png')) );
  wrap.appendChild( buildMiddleLeadership(TAH, QIY) );
  wrap.appendChild( buildMetricCard('ุงููุฏุฑุงุช', QIY, ()=>metricModal.open('ุงููุฏุฑุงุช','qiyas_image.png')) );
}
</script>
<!-- PART 7/8: FULL ANALYSIS, EVIDENCE, REPORT/PLAN & INIT -->
<script>
/* Full panel & evidence */
let currentFieldKey=null;
const eviStore = {}; // { rowId: [ {text,term,week,date,link,fileName} ] }

function openFieldFullScreen(key){
  currentFieldKey=key;
  const panel=document.getElementById('fullPanel');
  const title=document.getElementById('fpTitle');
  const body=document.getElementById('fpBody');
  const f=fields[key]; title.textContent='ุงูุชุญููู ุงูุชูุตููู โ '+f.name;

  const subsHtml=f.subs.map(s=>{
    const lb=perfLevel(s.v);
    return `<div class="subCard" style="border-color:${lb.color}30">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
        <strong>${s.name}</strong>
        <span class="chip" style="font-size:12px;color:${lb.color}">${fmt(s.v)}% โข ${lb.name}</span>
      </div>
    </div>`;
  }).join('');

  const rows=(detailed[key]||[]).map((r,idx)=>{
    const rowId = `${key}-${idx}`;
    const lb=perfLevel(r.perf);
    const chips = (eviStore[rowId]||[]).map((ev,i)=>`<span class="eviDot" title="${ev.text||''}">${i+1}</span>`).join('') || 'โ';
    return `<tr class="${levelRowClass(r.level)}" data-row="${rowId}">
      <td class="col-lvl">
        <div style="display:flex;align-items:center;gap:10px">
          <div class="miniGauge" data-p="${r.perf}" data-color="${lb.color}"></div>
          <div style="line-height:1.1">
            <span style="font-weight:800;color:${lb.color}">${r.level}</span><br/>
            <span style="font-size:12px;color:#6f8e94">${fmt(r.perf)}% โข ${r.code}</span>
          </div>
        </div>
      </td>
      <td class="col-crit"><strong>${r.indicator}</strong><br/><small style="color:#6f8e94">${r.evidence||''}</small></td>
      <td class="col-imp">${r.improve}</td>
      <td class="col-evi">
        <div class="eviBar">${chips}</div>
        <div class="eviBtns">
          <button class="btn-evi add">โ ุฅุถุงูุฉ ุดุงูุฏ</button>
          <button class="btn-evi danger del">๐๏ธ ุญุฐู ุขุฎุฑ</button>
        </div>
      </td>
    </tr>`;
  }).join('');

  body.innerHTML=`<div class="subgrid">${subsHtml}</div>
  <div class="tableWrap"><table>
    <thead><tr>
      <th class="col-lvl">ุงููุณุชูู/ุงูุฃุฏุงุก</th>
      <th class="col-crit">ุงููุนูุงุฑ/ุงููุคุดุฑ</th>
      <th class="col-imp">ููุชุฑุญุงุช ุงูุชุญุณูู</th>
      <th class="col-evi">ุงูุดูุงูุฏ</th>
    </tr></thead>
    <tbody>${rows}</tbody></table></div>`;

  // mini gauges
  document.querySelectorAll('.miniGauge').forEach(el=>{
    const p=parseFloat(el.dataset.p)||0, color=el.dataset.color||'#0b7e88';
    const r=14, c=2*Math.PI*r;
    el.innerHTML=`
      <svg viewBox="0 0 40 40">
        <circle cx="20" cy="20" r="${r}" stroke="#e6efef" stroke-width="6" fill="none"></circle>
        <circle class="fg" cx="20" cy="20" r="${r}" stroke="${color}" stroke-width="6" fill="none" stroke-linecap="round" style="transform:rotate(-90deg);transform-origin:50% 50%;stroke-dasharray:${c};stroke-dashoffset:${c}"></circle>
        <text x="20" y="20" style="font-size:9px;fill:#345;font-weight:700;dominant-baseline:middle;text-anchor:middle">${Math.round(p)}</text>
      </svg>`;
    requestAnimationFrame(()=>{el.querySelector('.fg').style.transition='.9s ease';el.querySelector('.fg').style.strokeDashoffset=c*(1 - (p/100));});
  });

  // buttons
  document.getElementById('btnFieldReport').onclick=()=>openDocWindow('ุชูุฑูุฑ ุงููุฌุงู',buildFieldReportHTML(key));
  document.getElementById('btnFieldPlan').onclick=()=>openDocWindow('ุฎุทุฉ ุชุญุณูู ุงููุฌุงู',buildFieldPlanHTML(key));
  document.getElementById('fpClose').onclick=(e)=>{e.preventDefault(); panel.style.display='none';};
  document.getElementById('fpHome').onclick=(e)=>{e.preventDefault(); panel.style.display='none';window.scrollTo({top:0,behavior:'smooth'})};

  // evidence row buttons
  body.querySelectorAll('tr[data-row]').forEach(tr=>{
    const rowId=tr.getAttribute('data-row');
    tr.querySelector('.btn-evi.add').addEventListener('click',()=>openEvidenceModal(rowId));
    tr.querySelector('.btn-evi.del').addEventListener('click',()=>{
      if((eviStore[rowId]||[]).length){ eviStore[rowId].pop(); refreshRowEvidence(rowId); }
    });
  });

  panel.style.display='flex';
}
function refreshRowEvidence(rowId){
  const tr=document.querySelector(`tr[data-row="${rowId}"]`);
  if(!tr) return;
  const bar=tr.querySelector('.eviBar');
  const items=eviStore[rowId]||[];
  bar.innerHTML = items.length? items.map((ev,i)=>`<span class="eviDot" title="${ev.text||''}">${i+1}</span>`).join('') : 'โ';
}

/* Evidence modal control */
const eviModalEl = { modal:null, text:null, term:null, week:null, hijri:null, file:null, link:null, owner:null, save:null, cancel:null, rowId:null };
function openEvidenceModal(rowId){
  eviModalEl.rowId=rowId;
  eviModalEl.modal.style.display='flex'; eviModalEl.modal.setAttribute('aria-hidden','false');
  eviModalEl.owner.value = 'ูุฌุงู: ' + (currentFieldKey||'');
}
function closeEvidenceModal(){ eviModalEl.modal.style.display='none'; eviModalEl.modal.setAttribute('aria-hidden','true'); eviModalEl.rowId=null; }
function saveEvidence(){
  const id=eviModalEl.rowId; if(!id) return;
  const item={ text:eviModalEl.text.value.trim(), term:eviModalEl.term.value, week:eviModalEl.week.value, date:eviModalEl.hijri.value.trim(), link:eviModalEl.link.value.trim(), fileName: eviModalEl.file.files[0]?.name || '' };
  if(!eviStore[id]) eviStore[id]=[]; eviStore[id].push(item);
  refreshRowEvidence(id); closeEvidenceModal();
  eviModalEl.text.value=''; eviModalEl.hijri.value=''; eviModalEl.link.value=''; eviModalEl.file.value='';
}

/* Report builder (narrow level/pct/code) */
function buildFieldReportHTML(key){
  const f=fields[key];
  const rows=(detailed[key]||[]).map(r=>`
    <tr class="${levelRowClass(r.level)}">
      <td style="width:140px">${r.level}<br/>${fmt(r.perf)}%<br/><small>${r.code}</small></td>
      <td style="width:40%">${r.indicator}</td>
      <td style="width:auto">${r.improve}</td>
    </tr>`).join('');
  return `<h2 style="text-align:center;color:#0b7e88;margin-bottom:8px">ุชูุฑูุฑ ุงููุฌุงู: ${f.name}</h2>
  <table><thead><tr><th style="width:140px">ุงููุณุชูู/ุงููุณุจุฉ/ุงูุฑูุฒ</th><th style="width:40%">ุงููุนูุงุฑ/ุงููุคุดุฑ</th><th>ููุชุฑุญุงุช ุงูุชุญุณูู</th></tr></thead><tbody>${rows}</tbody></table>`;
}

/* Plan builder (narrow code + duration) */
function buildFieldPlanHTML(key){
  const f=fields[key];
  const rows=(detailed[key]||[]).map((r,i)=>{
    const duration = i%2? 'ูฆ ุฃุณุงุจูุน':'ูุตู ุฏุฑุงุณู';
    return `<tr>
      <td style="width:110px"><strong>${r.code}</strong></td>
      <td style="width:auto">${r.indicator}</td>
      <td style="width:auto">${r.improve}</td>
      <td style="width:110px">${duration}</td>
    </tr>`;
  }).join('');
  return `<h2 style="text-align:center;color:#0b7e88;margin-bottom:8px">ุฎุทุฉ ุชุญุณูู ุงููุฌุงู: ${f.name}</h2>
  <table><thead><tr><th style="width:110px">ุฑูุฒ ุงููุคุดุฑ</th><th>ุงููุฏู/ุงููุคุดุฑ</th><th>ุงูุฅุฌุฑุงุก ุงูุชุญุณููู</th><th style="width:110px">ุงููุฏุฉ</th></tr></thead><tbody>${rows}</tbody></table>`;
}

/* Print window (wide + centered) */
function openDocWindow(title,contentHTML){
  const w=window.open('','_blank'); if(!w){alert('ูุถูุงู ุงุณูุญ ุจุงูููุงูุฐ ุงูููุจุซูุฉ.');return;}
  const doc=`<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="utf-8"/><title>${title}</title>
  <style>
    *{box-sizing:border-box} html,body{margin:0;font-family:'Tajawal',sans-serif;color:#06353b;background:#fff}
    @page{size:A4;margin:8mm} html,body{-webkit-print-color-adjust:exact; print-color-adjust:exact}
    .wrap{width:200mm;max-width:100%;margin:0 auto;padding:10px}
    h2{text-align:center;margin:6px 0 10px}
    table{width:100%;border-collapse:collapse;table-layout:fixed}
    thead th{background:#0f6f79;color:#fff;padding:10px}
    td,th{padding:8px;border:1px solid #e7eff0;text-align:center;vertical-align:middle}
    .row-excellent{background:#e9fff4}.row-verygood{background:#eef5ff}.row-good{background:#fff6ec}.row-medium{background:#ffefef}
    .toolbar{position:sticky;bottom:0;display:flex;justify-content:center;margin:10px 0}
    .print{padding:8px 12px;border:1px solid #0b7e88;border-radius:10px;background:#0b7e88;color:#fff;cursor:pointer}
    @media print{ .toolbar{display:none} }
  </style></head><body>
    <div class="wrap">${contentHTML}
      <div class="toolbar"><button class="print" onclick="window.print()">ุทุจุงุนุฉ</button></div>
    </div></body></html>`;
  w.document.open(); w.document.write(doc); w.document.close();
}

/* Metric image modal controller */
const metricModal = { el:null, img:null, title:null, open:(title,src)=>{
  metricModal.el.style.display='flex'; metricModal.img.src = src; metricModal.title.textContent = title; metricModal.el.setAttribute('aria-hidden','false');
}, close:()=>{ metricModal.el.style.display='none'; metricModal.el.setAttribute('aria-hidden','true'); }};

/* INIT */
window.addEventListener('DOMContentLoaded',()=>{
  // Top links
  document.getElementById('btnExt2025').onclick=(e)=>{e.preventDefault();window.open(SRC_2025,'_blank','noopener');};
  document.getElementById('btnExt2024').onclick=(e)=>{e.preventDefault();window.open(SRC_2024,'_blank','noopener');};
  document.getElementById('btnFullPlan').onclick=(e)=>{e.preventDefault();window.open(PLAN_LINK,'_blank','noopener');};
  document.getElementById('btnOps').onclick   =(e)=>{e.preventDefault();window.open(OPS_LINK,'_blank','noopener');};
  document.getElementById('btnAnalyze').onclick=(e)=>{e.preventDefault(); renderDashboard(); window.scrollTo({top:document.getElementById('dashboard').offsetTop-10,behavior:'smooth'});};

  // Metric modal
  metricModal.el = document.getElementById('metricModal');
  metricModal.img = document.getElementById('metricModalImg');
  metricModal.title = document.getElementById('metricModalTitle');
  document.getElementById('metricModalClose').onclick=()=>metricModal.close();
  metricModal.el.addEventListener('click',(ev)=>{const sheet=metricModal.el.querySelector('.sheet'); if(!sheet.contains(ev.target)) metricModal.close();});

  // Evidence modal refs
  const m=document.getElementById('eviModal');
  eviModalEl.modal=m;
  eviModalEl.text=document.getElementById('eviText');
  eviModalEl.term=document.getElementById('eviTerm');
  eviModalEl.week=document.getElementById('eviWeek');
  eviModalEl.hijri=document.getElementById('eviHijri');
  eviModalEl.file=document.getElementById('eviFile');
  eviModalEl.link=document.getElementById('eviLink');
  eviModalEl.owner=document.getElementById('eviOwner');
  eviModalEl.save=document.getElementById('eviSave');
  eviModalEl.cancel=document.getElementById('eviCancel');

  // Weeks 1..19
  eviModalEl.week.innerHTML=''; for(let i=1;i<=19;i++){ const op=document.createElement('option'); op.value='W'+i; op.textContent='ุงูุฃุณุจูุน '+i; eviModalEl.week.appendChild(op); }
  document.getElementById('eviClose').onclick=closeEvidenceModal;
  eviModalEl.cancel.onclick=closeEvidenceModal;
  eviModalEl.save.onclick=saveEvidence;

  // Render on load (ุญุชู ูู ูู ูุถุบุท "ุชุญููู ุดุงูู")
  renderDashboard();
  renderMetricsSection();
});
</script>
<!-- PART 8/8: CLOSE -->
</body>
</html>
